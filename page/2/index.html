<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>778477</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="778477">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="778477">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="778477">
<meta name="twitter:description">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo logo-text" href="/">778477</a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer">
      <article id="post-2016-10-24-QCon2016上海站见闻" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/24/2016-10-24-QCon2016上海站见闻/">QCon 2016 上海站见闻</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/10/24/2016-10-24-QCon2016上海站见闻/" class="article-date">
  <time datetime="2016-10-24T00:00:00.000Z" itemprop="datePublished">2016-10-24</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/QCon/">QCon</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>有幸参与了QCon 2016的上海站会议。官方宣传这是一个中高端会议，专题丰富涵盖了当前互联网各种技术领域。</p>
<table>
<thead>
<tr>
<th>10月20号周四</th>
<th style="text-align:center">10月21号周五</th>
<th style="text-align:right">10月22号周五</th>
</tr>
</thead>
<tbody>
<tr>
<td>前端技术实践</td>
<td style="text-align:center">玩转大数据</td>
<td style="text-align:right">Growth Hacking，IoT &amp; React Native</td>
</tr>
<tr>
<td>安全之战</td>
<td style="text-align:center">移动开发探索</td>
<td style="text-align:right">互联网广告系统实战</td>
</tr>
<tr>
<td>新Java，新未来</td>
<td style="text-align:center">移动视频</td>
<td style="text-align:right">工程团队管理</td>
</tr>
<tr>
<td>无处不在的容器</td>
<td style="text-align:center">让架构更简单</td>
<td style="text-align:right">技术创业</td>
</tr>
<tr>
<td>微服务架构，我们该如何实践？</td>
<td style="text-align:center">运维与监控</td>
<td style="text-align:right">机器学习与深度学习</td>
</tr>
<tr>
<td>大数据应用与系统优化实践(厂商共建专题)</td>
<td style="text-align:center">大数据服务与应用</td>
<td style="text-align:right">用户体验设计</td>
</tr>
<tr>
<td>业务上云技术拆解(厂商共建专题)</td>
<td style="text-align:center">高并发与实时处理架构设计(厂商共建专题)</td>
<td style="text-align:right">研发支撑体系</td>
</tr>
<tr>
<td>智能出行 - 高德开放平台专场(厂商共建专题)</td>
<td style="text-align:center">微服务实践与架构演进之路(厂商共建专题)</td>
<td style="text-align:right">业务系统架构</td>
</tr>
<tr>
<td></td>
<td style="text-align:center"></td>
<td style="text-align:right">大数据分析与应用</td>
</tr>
<tr>
<td></td>
<td style="text-align:center"></td>
<td style="text-align:right">大规模前端系统</td>
</tr>
</tbody>
</table>
<p><a href="http://ppt.geekbang.org/qconsh2016" target="_blank" rel="external">QCon 上海站PPT 下载</a></p>
<p>其中每个专题会在固定的宴会厅进行，由专题出品人主持专题的会议开展。专题下面是各个议题，时长大致为45分钟包含Q&amp;A环节。</p>
<p>根据自身技术栈出发，我选择了以下专题</p>
<ul>
<li>20号 前端技术实践</li>
<li>21号 移动开发探索</li>
<li>22号 Growth Hacking &amp; 用户体验设计 &amp; 技术创业</li>
</ul>
<h2 id="前端技术实践"><a href="#前端技术实践" class="headerlink" title="前端技术实践"></a>前端技术实践</h2><p>周四的专题对于 客户端开发来说稍显尴尬，没有与之相关的议题。 我选择了和客户端相对平等的前端专题。 下面重点介绍一下我认为有意思的议题：</p>
<h3 id="Vue-2-0-渐进式前端解决方案"><a href="#Vue-2-0-渐进式前端解决方案" class="headerlink" title="Vue 2.0: 渐进式前端解决方案"></a>Vue 2.0: 渐进式前端解决方案</h3><p>讲师@尤雨溪，很早就关注他了。这次总算见到真人了。<a href="https://github.com/vuejs/vue" target="_blank" rel="external">Vue</a>已经在Github上收获了3w+颗star，对于开源项目来说，无疑是相当成功了。</p>
<p>我很认同他对框架的理解。<strong>框架的存在是为了帮助我们应对复杂度。但同时框架也有复杂度，Pick the right tool for the job.</strong></p>
<p>开篇的框架理解引出了 Vue ，这个渐进式前端解决方案。可能就是他对当下JS开发环境的一个答案。</p>
<p>框架本身，我不是JS开发，没有使用经历就不做主观评价了。 回到一开始的”框架”，他是如何解决框架复杂度的呢？ 答案是”渐进式”。</p>
<p><img src="https://github.com/778477/778477.github.io/blob/51ed1eda4322c046a4bfe958f96dfcb3c744f7ec/img/Vue-Progressive.png?raw=true" alt="progressive"></p>
<p>Vue框架提供 声明式渲染 核心功能，加上可选的附加库/工具链，来打造弹性复杂度。这个区别于传统框架，集成整合了一整套解决方案。提高框架复杂度，增加开发者的学习使用成本。</p>
<p>这种框架的设计思路，是明智的。</p>
<h3 id="Progressive-Web-App：反击序章"><a href="#Progressive-Web-App：反击序章" class="headerlink" title="Progressive Web App：反击序章"></a>Progressive Web App：反击序章</h3><p>讲师@黄玄开篇讲述了web在当下移动时代的窘境。有一定的技术高度看待这类行业问题是蛮赞的。不认可web在移动时代只有Hybrid这一种选择。</p>
<p>开始布道 PWA(Progressive Web App),认为这是web针对native的一次反击。<br><strong>The new application model for Web</strong></p>
<ul>
<li>add To HomeScreen (web 也有像native原生应用一样的桌面图标入口)</li>
<li>Instant Loading &amp; ReliableExperience (提供一种缓存机制，类似原生应用的首次下载)</li>
<li>Push Notifications (web 也可以像原生应用一样接受通知)</li>
</ul>
<p>…等等一些特性。让我这种native同学感到十分新鲜。确实<strong>在 纯web 到 纯navite 之间有许多可能的点</strong>。</p>
<p>反观业界，应该很少有企业对自己的网站能支持到这种体验程度。特别是在iOS 9提供了 web mark机制之后，直接把web流量切给了native。不知道有没有统计过用户是愿意留在浏览器 还是 更愿意跳往原生应用</p>
<p>不过在原生应用开发实践中，我个人偏向于 hybrid 方案。这个取决于你的App大多数是什么样的业务场景，需要权衡体验和发布节奏等利益点。</p>
<ol>
<li>纯native，体验是有可以保证的。 缺点就是发版受限</li>
<li>hybrid，这里讨论指的是 RN，Weex这种跨端方案。好处是 发布不受限制，一人开发跨两端(iOS,Android) 节省人力。体验稍逊于native</li>
<li>纯web，包括不经优化，直接套用webview的这种。缺点是体验差，卡顿，load时间久</li>
</ol>
<h2 id="移动开发探索"><a href="#移动开发探索" class="headerlink" title="移动开发探索"></a>移动开发探索</h2><p>这个专题与我息息相关，吸引的我是这些议题</p>
<h3 id="React-Native-业务实践和性能优化"><a href="#React-Native-业务实践和性能优化" class="headerlink" title="React Native 业务实践和性能优化"></a>React Native 业务实践和性能优化</h3><p><img src="https://github.com/778477/778477.github.io/blob/c35a39b54f811e27512715841869cb6dd1b1ca2c/img/who%20use%20RN.png?raw=true" alt="who use RN"></p>
<p>讲师 携程@赵辛贵。 携程积极拥抱RN技术，多数业务和页面使用RN搭建。<br>好处明显</p>
<ul>
<li>size优势，RN页面大小计算脱离原生包大小</li>
<li>支持动态发布，跨端节省开发人力</li>
<li>RN技术成熟，社区活跃(参会时和旁边的途牛网开发交流，他们动态方案也是选择RN)</li>
</ul>
<p>携程内部还演化出了CRN(ctrip RN)业务框架。做了性能和稳定性优化(思路参见PPT)，规划支持CRN-web实现跨三端(iOS,android,H5)。</p>
<p>外界RN动态方案使用的如火如荼，他们正在证明这是未来移动前端开发的方向。</p>
<h3 id="Weex-极致性能优化"><a href="#Weex-极致性能优化" class="headerlink" title="Weex 极致性能优化"></a>Weex 极致性能优化</h3><p>公司同学分享，Weex性能优化的几个思路方向。围绕性能，干货较多。<br>不过，这种经历只能听听思路。 基本没有实践复用场景 ：）<br>安利Weex性能很好，倒是真的。</p>
<h3 id="蘑菇街-App-的稳定性与性能实践"><a href="#蘑菇街-App-的稳定性与性能实践" class="headerlink" title="蘑菇街 App 的稳定性与性能实践"></a>蘑菇街 App 的稳定性与性能实践</h3><p>从用户角度出发看 性能和稳定性问题：</p>
<ul>
<li>闪退</li>
<li>打开慢</li>
<li>滑动不流畅</li>
<li>耗电</li>
<li>网络不畅/出错</li>
<li>流量大</li>
</ul>
<p>都是客户端常见的问题，相信各大公司都有自己的答案实践。</p>
<p>他们有一个比较有意思的工具：AppMate(小蘑菇) 提供给测试和业务开发进行开发阶段的一个性能把控。</p>
<p>或许是在阿里的原因，这些东西听来都不足以让我兴奋。</p>
<h2 id="Growth-Hacking-最新动态和最佳实践"><a href="#Growth-Hacking-最新动态和最佳实践" class="headerlink" title="Growth Hacking 最新动态和最佳实践"></a>Growth Hacking 最新动态和最佳实践</h2><p>这个是受团队运营产品委托，刻意留意了这个议题(我所在的天猫team也负责push通道来召回用户，提高留存)</p>
<h3 id="Growth-Hacking-最新动态和最佳实践-1"><a href="#Growth-Hacking-最新动态和最佳实践-1" class="headerlink" title="Growth Hacking 最新动态和最佳实践"></a>Growth Hacking 最新动态和最佳实践</h3><ol>
<li>数据看板 - 数据分析 - 数据监控 </li>
<li>数据驱动产品决策</li>
<li>AB 测试实验</li>
<li>灰度渠道发布</li>
</ol>
<p>其中的数据分析提到：”Core Action” 指到的是核心操作，关键路径到达。<br>列举了几类APP的”Core Action”</p>
<table>
<thead>
<tr>
<th>APP类型</th>
<th style="text-align:center">Core Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>Facebook</td>
<td style="text-align:center">connect(连接？相互关注？朋友互动？)</td>
</tr>
<tr>
<td>Slack/Wechat</td>
<td style="text-align:center">接发信息</td>
</tr>
<tr>
<td>Pinterest</td>
<td style="text-align:center">晒图</td>
</tr>
<tr>
<td>电商</td>
<td style="text-align:center">浏览、下单购买</td>
</tr>
<tr>
<td>知乎</td>
<td style="text-align:center">回答，点赞，收藏，感谢</td>
</tr>
<tr>
<td>互联网金融</td>
<td style="text-align:center">购买理财产品</td>
</tr>
<tr>
<td>二手车</td>
<td style="text-align:center">购买，砍价</td>
</tr>
</tbody>
</table>
<p>这里有一个观点 <strong>重点关心产品核心操作是否被用户触达</strong><br><img src="https://github.com/778477/778477.github.io/blob/ab7afbca4d9a27b303743598400c76fa1651c367/img/growth-push-recall.png?raw=true" alt="recall"><br>这个模型 描述了 新客或流失客户(最近打开app的时候是在30-60天之前)，我们应该积极的通过Push通道来进行用户召回，当用户下沉为忠实用户之后。要谨慎使用push。这个模型是可逆的，也就是说当用户不再活跃的时候，回归上层我们也要通过push相关利益点来进行召回。</p>
<p>分享了业界做病毒式扩散的几个经典例子：</p>
<ol>
<li>airbnb 分享给朋友，两方都能获得25刀的优惠券</li>
<li>PRISMA 图片滤镜软件 制作图片打上软件水印</li>
<li>Pokémon Go 户外现象级户外捕捉小精灵</li>
</ol>
<p>这些快速扩散区别于 用户推荐和口口相传。分享者和你分享的时候，并不是在说这个平台或者软件如何如何，还是在和你分享他们得到了什么。分享一定要满足用户一些心理：增加声望、财富、乐趣。</p>
<p>最后病毒式扩散一定要作用在Core Action上。</p>
<h3 id="产品思维和设计思维详解"><a href="#产品思维和设计思维详解" class="headerlink" title="产品思维和设计思维详解"></a>产品思维和设计思维详解</h3><p>讲师 @张玉婷，她的设计思路蛮不错的。她认为设计师设计产品交互的时候，一定是从产品架构出发分析产品用户需求，进而推导出产品界面。而不是接到需求在网上一通翻找竞品界面。不同的需求场景有不同的用户语境，进而有不同的视觉交互表达。</p>
<p>比如 从业参与的Weico客户端，是设计驱动的一个产品。目前是最大的微博第三方客户端，跳脱开 官方微博客户端的通用性和功能化，主打个性化和情感化。围绕核心功能(阅读和发送微博)进行 特色的设计扩展。</p>
<p>后面提及高德客户端的交互设计，虽然 App类型不同，设计很难参考。但思路是ok的。要关注 用户与产品发生交互的真实场景，介绍了高德在这方面的交互实践。</p>
<h3 id="如何选好技术初创风口：从0到1，1到100"><a href="#如何选好技术初创风口：从0到1，1到100" class="headerlink" title="如何选好技术初创风口：从0到1，1到100"></a>如何选好技术初创风口：从0到1，1到100</h3><p>这个。实话说我睡着了，可能是吃完中饭乏了。恩，是的。</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/QCon-上海2016/">QCon 上海2016</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2016-10-03-Gas Station" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/03/2016-10-03-Gas Station/">Gas Station</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/10/03/2016-10-03-Gas Station/" class="article-date">
  <time datetime="2016-10-03T00:00:00.000Z" itemprop="datePublished">2016-10-03</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a><span>></span><a class="article-category-link" href="/categories/Algorithm/LeetCode/">LeetCode</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://leetcode.com/problems/gas-station/" target="_blank" rel="external">LeetCode - 134.Gas Station</a></p>
<h2 id="题目大意："><a href="#题目大意：" class="headerlink" title="题目大意："></a>题目大意：</h2><p>有<code>n</code>个加油站分布在 环形路线上。其中每个加油站的储油量为 <code>gas[i]</code>。 你有一辆巨大油箱(可以无限加油)的汽车,从 站点<code>i</code>到下一站<code>i+1</code>，油耗为 <code>cost[i]</code>。一开始的时候，汽车油箱是空的。</p>
<p>如果你能一次开完全程的话，请返回一个起始站点。否则返回-1表示无法完成。</p>
<ul>
<li><p>提示： 测试用例保证答案是唯一的。</p>
</li>
<li><p>疑问：题目未明显指出 是顺时针开或逆时针开。但从测试数据理解 站点i 到 站点i+1，应该是顺时针开的。</p>
</li>
</ul>
<h2 id="解题思路："><a href="#解题思路：" class="headerlink" title="解题思路："></a>解题思路：</h2><p>首先可以明确的是，如果 总油耗<code>sum{cost[0...n]}</code> 大于 总储量<code>sum{gas[0...n]}</code>的话，是无法完成任务的。直接返回-1。</p>
<p>接着，思考一下当 总油耗 小等于 总储量时，是否必然存在可行解。</p>
<p> C(i) + C(i+1) + C(i+2) + C(i+3) … + C(i+n) = C</p>
<p> G(i) + G(i+1) + G(i+2) + G(i+3) … + G(i+n) = G</p>
<p> G &gt;= C</p>
<p> 如果 平均分布的话， 则 G(i)&gt;=C(i) 。 必然是ok的。</p>
<p> 考虑极限情况，C(i) 油耗巨大。贪心策略保证每站必停(油不加白不加)，我们从i站点<code>逆时针</code>选点。基于贪心考虑，逆时针选站点要保证对经过C(i)最大油耗是有利：每一次后退选点对总油耗是正向的。</p>
<h2 id="枚举-Time-Limit-Exceeded"><a href="#枚举-Time-Limit-Exceeded" class="headerlink" title="枚举 (Time Limit Exceeded)"></a>枚举 (Time Limit Exceeded)</h2><p>时间复杂度 大致为 O(n^2)。 测试用例数据极为暴力。。</p>
 <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">int</span> <span class="title">goRound</span><span class="params">(<span class="keyword">int</span> starInx,<span class="keyword">int</span> *gas,<span class="keyword">int</span> gasSize,<span class="keyword">int</span> *cost,<span class="keyword">int</span> costSize)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> nowGas = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> nowIdx = starInx;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;gasSize;i++)&#123;</span><br><span class="line">        nowGas += gas[nowIdx];</span><br><span class="line">        <span class="keyword">if</span>(nowGas &lt; cost[nowIdx]) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        </span><br><span class="line">        nowGas -= cost[nowIdx];</span><br><span class="line">        nowIdx = (nowIdx+<span class="number">1</span>)%gasSize;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> nowGas &gt;= <span class="number">0</span> ? starInx : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">canCompleteCircuit</span><span class="params">(<span class="keyword">int</span>* gas, <span class="keyword">int</span> gasSize, <span class="keyword">int</span>* cost, <span class="keyword">int</span> costSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">int</span> totalGas = <span class="number">0</span>, totalCosts = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;costSize;i++)&#123;</span><br><span class="line">        totalCosts += cost[i];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;gasSize;i++)&#123;</span><br><span class="line">        totalGas += gas[i];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(totalGas &lt; totalCosts) <span class="keyword">return</span> ans;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;gasSize;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>((ans = goRound(i,gas,gasSize,cost,costSize)) != <span class="number">-1</span>)&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="贪心-Accepted"><a href="#贪心-Accepted" class="headerlink" title="贪心 (Accepted)"></a>贪心 (Accepted)</h2> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">int</span> <span class="title">canCompleteCircuit</span><span class="params">(<span class="keyword">int</span>* gas, <span class="keyword">int</span> gasSize, <span class="keyword">int</span>* cost, <span class="keyword">int</span> costSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> totalGas = <span class="number">0</span>, totalCosts = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> maxCostIdx = <span class="number">-1</span>, maxCost = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;costSize;i++)&#123;</span><br><span class="line">        totalCosts += cost[i];</span><br><span class="line">        <span class="keyword">if</span>(cost[i] &gt; maxCost)&#123;</span><br><span class="line">            maxCostIdx = i;</span><br><span class="line">            maxCost = cost[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;gasSize;i++)&#123;</span><br><span class="line">        totalGas += gas[i];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(totalGas &lt; totalCosts) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> tmp = maxCostIdx;</span><br><span class="line">    <span class="keyword">int</span> tmpMaxgas = gas[tmp];</span><br><span class="line">    <span class="keyword">int</span> tmpMaxCost = cost[tmp];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (tmpMaxgas &lt; tmpMaxCost || gas[tmp] &gt;= cost[tmp]) &#123; <span class="comment">// 贪心策略</span></span><br><span class="line">        tmp--;</span><br><span class="line">        <span class="keyword">if</span>(tmp == <span class="number">-1</span>) tmp = gasSize - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(tmp == maxCostIdx) <span class="keyword">break</span>;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        tmpMaxgas += gas[tmp];</span><br><span class="line">        tmpMaxCost += cost[tmp];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (tmp+<span class="number">1</span>)%gasSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> <img src="https://raw.githubusercontent.com/778477/778477.github.io/baa6788ce066521a1d0c315c37894e4791c99f55/img/gas-station.png" alt="Accepted"></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LeetCode/">LeetCode</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2016-09-22-SDWebImage读码笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/22/2016-09-22-SDWebImage读码笔记/">SDWebImage 读码笔记</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/09/22/2016-09-22-SDWebImage读码笔记/" class="article-date">
  <time datetime="2016-09-22T00:00:00.000Z" itemprop="datePublished">2016-09-22</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a><span>></span><a class="article-category-link" href="/categories/iOS/读码笔记/">读码笔记</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th>Watch</th>
<th style="text-align:left">Star</th>
<th style="text-align:left">Fork</th>
<th style="text-align:left">Open Issues</th>
<th style="text-align:left">Closed Issue</th>
</tr>
</thead>
<tbody>
<tr>
<td>823</td>
<td style="text-align:left">15711</td>
<td style="text-align:left">4432</td>
<td style="text-align:left">133</td>
<td style="text-align:left">1021</td>
</tr>
</tbody>
</table>
<p>从 Star 和 Issue 维度来看SDWebImage可谓是万众瞩目和久经考验。 </p>
<p><a href="https://github.com/rs/SDWebImage/blob/master/README.md" target="_blank" rel="external">SDWebImage-README</a></p>
<p><a href="https://github.com/rs/SDWebImage/wiki/How-is-SDWebImage-better-than-X%3F" target="_blank" rel="external">How is SDWebImage better than X?</a></p>
<p>下面，我们来细致的阅读一下 SDWebImage(简称 SD)的源码。 </p>
<h1 id="一些良好的编码习惯"><a href="#一些良好的编码习惯" class="headerlink" title="一些良好的编码习惯"></a>一些良好的编码习惯</h1><ul>
<li><p>SD的扩展命名风格不错。 带有sd_ 下划线前缀以此来区分是否为 三方库扩展。避免 扩展方法重名 覆盖问题。</p>
<ol>
<li>同样的命名风格适用于 类名。前缀可以避免OC语言没有命名空间的尴尬。 </li>
<li>不过需要注意的是，Cocoa应用程序Apple宣称拥有”两字母前缀”的权利。 所以有可能在不远的将来，SD要面临 命名冲突的问题。</li>
</ol>
</li>
<li><p>对于SD废弃的方法。 SD的做法是 将方法移至 对应的<code>Deprecated</code>中。 并在方法申明的时候给出提示。这种做法，笔者也比较认同。 SDK对外的接口变更是不可避免的。在版本更新中直接删除的话，会让依赖方有改造成本。对废弃方法进行警告声明，实现上调用新方法是比较优雅和无害的。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@interface UIImageView (WebCacheDeprecated)</span><br><span class="line">- (NSURL *)imageURL __deprecated_msg(&quot;Use `sd_imageURL`&quot;);</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<ul>
<li><p>使用类型常量。 Effective Objective-C 2.0 中的第四条实践。</p>
<p><code>SDWebImageCompat.h</code> </p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extern NSString *const SDWebImageErrorDomain;</span><br></pre></td></tr></table></figure>
<p><code>SDWebImageCompat.m</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSString *const SDWebImageErrorDomain = @&quot;SDWebImageErrorDomain&quot;;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>使用inline 内联函数关键词。 inline这个关键词会<strong>建议</strong>编译器内联展开处理。inline这个关键词在C++上出场频率比较高。 关于<a href="http://www.sunistudio.com/cppfaq/inline-functions.html" target="_blank" rel="external">inline关键词的QA</a> 具体的性能影响可以看[9.3]。 <strong>笔者认为 inline仅适用于调用频繁的短函数</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> inline UIImage *SDScaledImageForKey(NSString *key, UIImage *image) &#123;</span><br><span class="line"> ...</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> FOUNDATION_STATIC_INLINE NSUInteger SDCacheCostForImage(UIImage *image) &#123;</span><br><span class="line">    return image.size.height * image.size.width * image.scale * image.scale;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p> <a href="http://www.cnblogs.com/cnmaizi/archive/2011/01/19/1939686.html" target="_blank" rel="external">关于inline的扩展阅读</a> </p>
<ul>
<li>使用 <code>dispatch_barrier_sync</code> 来保证一些多线程操作的原子性。 笔者也做过一些 <a href="https://github.com/778477/iOS-Lock-BenchMarking" target="_blank" rel="external">iOS 锁的branchMarking</a></li>
</ul>
<h1 id="关于SDWebImage图片下载实现的细节"><a href="#关于SDWebImage图片下载实现的细节" class="headerlink" title="关于SDWebImage图片下载实现的细节"></a>关于SDWebImage图片下载实现的细节</h1><ul>
<li>如何识别 图片格式？ 是jpg，png还是gif呢？ SD的 NSData扩展方法可以告诉你。根据图片的具体数据内容，可以看出对应的格式</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">@implementation NSData (ImageContentType)</span><br><span class="line"></span><br><span class="line">+ (NSString *)sd_contentTypeForImageData:(NSData *)data &#123;</span><br><span class="line">    uint8_t c;</span><br><span class="line">    [data getBytes:&amp;c length:1];</span><br><span class="line">    switch (c) &#123;</span><br><span class="line">        case 0xFF:</span><br><span class="line">            return @&quot;image/jpeg&quot;;</span><br><span class="line">        case 0x89:</span><br><span class="line">            return @&quot;image/png&quot;;</span><br><span class="line">        case 0x47:</span><br><span class="line">            return @&quot;image/gif&quot;;</span><br><span class="line">        case 0x49:</span><br><span class="line">        case 0x4D:</span><br><span class="line">            return @&quot;image/tiff&quot;;</span><br><span class="line">        case 0x52:</span><br><span class="line">            // R as RIFF for WEBP</span><br><span class="line">            if ([data length] &lt; 12) &#123;</span><br><span class="line">                return nil;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            NSString *testString = [[NSString alloc] initWithData:[data subdataWithRange:NSMakeRange(0, 12)] encoding:NSASCIIStringEncoding];</span><br><span class="line">            if ([testString hasPrefix:@&quot;RIFF&quot;] &amp;&amp; [testString hasSuffix:@&quot;WEBP&quot;]) &#123;</span><br><span class="line">                return @&quot;image/webp&quot;;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            return nil;</span><br><span class="line">    &#125;</span><br><span class="line">    return nil;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<ul>
<li>SD 缓存中的图片是 原始的，未解压的。</li>
</ul>
<blockquote>
<p>On the other side, SDWebImage caches the UIImage representation in memory and store the original compressed (but decoded) image file on disk. UIImage are stored as-is in memory using NSCache, so no copy is involved, and memory is freed as soon as your app or the system needs it.</p>
<p>Additionally, image decompression that normally happens in the main thread the first time you use UIImage in an UIImageView is forced in a background thread by SDWebImageDecoder.</p>
</blockquote>
<p>关于 图片的解压，可以查看<code>SDWebImageDecoder</code>的实现。 SD有对应<code>shouldDecompressImages</code>功能开关。默认是开启的。</p>
<p><a href="https://github.com/rs/SDWebImage/issues/1173" target="_blank" rel="external">What does SDWebImageDecoder do? #1173</a></p>
<h1 id="流程分析"><a href="#流程分析" class="headerlink" title="流程分析"></a>流程分析</h1><p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/SDWebImage.png" alt=""></p>
<h2 id="step-3"><a href="#step-3" class="headerlink" title="step. 3"></a>step. 3</h2><p>因为，SD实现了自己的图片缓存机制。所以，在下载流程中，SD会先检查一遍是否命中缓存。<br>SD的图片缓存key 为<code>url.absoluteString</code>，SD还有一个<code>缓存筛选机制</code>，用来支持删除 图片url动态变更的部分。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SDWebImageManager.h</span><br><span class="line">@property (nonatomic, copy) SDWebImageCacheKeyFilterBlock cacheKeyFilter;</span><br></pre></td></tr></table></figure>
<p>这个机制会作用于所有<code>cache key</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (NSString *)cacheKeyForURL:(NSURL *)url &#123;</span><br><span class="line">    if (!url) &#123;</span><br><span class="line">        return @&quot;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if (self.cacheKeyFilter) &#123;</span><br><span class="line">        return self.cacheKeyFilter(url);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return [url absoluteString];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Cache</code>实现部分参见<code>SDImageCache.h</code>。</p>
<ul>
<li>内存缓存部分，SD是使用<code>NSCahce</code></li>
<li><p>磁盘缓存部分，SD是读写文件操作</p>
<p>缓存部分，并无新意。<code>IO</code>注意异步线程操作即可。SD监听了应用 <code>DidReceiveMemoryWarning</code>，<code>WillTerminate</code>，<code>DidEnterBackground</code>等消息来处理自己的缓存，让缓存存储较为得体。应用内部缓存大小不影响宿主环境。</p>
<p><code>- (void)storeImage:(UIImage *)image recalculateFromImage:(BOOL)recalculate imageData:(NSData *)imageData forKey:(NSString *)key toDisk:(BOOL)toDisk</code> 中有一段代码挺有意思的。 SD的磁盘缓存是写入<code>imageData</code>，一般下载结束之后，SD是能拿到<code>image</code> 和 <code>imageData</code>的。 但如果只有<code>image</code>呢？ 磁盘缓存该如何写入？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"> if (image &amp;&amp; (recalculate || !data)) &#123;</span><br><span class="line">#if TARGET_OS_IPHONE</span><br><span class="line">                // We need to determine if the image is a PNG or a JPEG</span><br><span class="line">                // PNGs are easier to detect because they have a unique signature (http://www.w3.org/TR/PNG-Structure.html)</span><br><span class="line">                // The first eight bytes of a PNG file always contain the following (decimal) values:</span><br><span class="line">                // 137 80 78 71 13 10 26 10</span><br><span class="line"></span><br><span class="line">                // If the imageData is nil (i.e. if trying to save a UIImage directly or the image was transformed on download)</span><br><span class="line">                // and the image has an alpha channel, we will consider it PNG to avoid losing the transparency</span><br><span class="line">                int alphaInfo = CGImageGetAlphaInfo(image.CGImage);</span><br><span class="line">                BOOL hasAlpha = !(alphaInfo == kCGImageAlphaNone ||</span><br><span class="line">                                  alphaInfo == kCGImageAlphaNoneSkipFirst ||</span><br><span class="line">                                  alphaInfo == kCGImageAlphaNoneSkipLast);</span><br><span class="line">                BOOL imageIsPng = hasAlpha;</span><br><span class="line"></span><br><span class="line">                // But if we have an image data, we will look at the preffix</span><br><span class="line">                if ([imageData length] &gt;= [kPNGSignatureData length]) &#123;</span><br><span class="line">                    imageIsPng = ImageDataHasPNGPreffix(imageData);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if (imageIsPng) &#123;</span><br><span class="line">                    data = UIImagePNGRepresentation(image);</span><br><span class="line">                &#125;</span><br><span class="line">                else &#123;</span><br><span class="line">                    data = UIImageJPEGRepresentation(image, (CGFloat)1.0);</span><br><span class="line">                &#125;</span><br><span class="line">#else</span><br><span class="line">                data = [NSBitmapImageRep representationOfImageRepsInArray:image.representations usingType: NSJPEGFileType properties:nil];</span><br><span class="line">#endif</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>通过 是否有<code>alpha</code>通道 和 <code>ImageDataHasPNGPreffix</code> 来判断<code>image</code>类型，进而使用API进行<code>UIimage to NSData</code>。</p>
<h2 id="step-4"><a href="#step-4" class="headerlink" title="step. 4"></a>step. 4</h2><p>SD的下载核心逻辑是在<code>SDWebImageDownloader</code>。<code>Downloader</code>维护着一个线程池，控制<code>SDWebImageDownloaderOperation</code>最小单元下载任务。</p>
<ul>
<li>默认并发下载量为6。可以通过<code>maxConcurrentDownloads</code>修改。</li>
<li>下载超时时限默认为15.0。 可以通过<code>downloadTimeout</code>修改。</li>
<li>下载任务执行顺序策略有 <code>SDWebImageDownloaderFIFOExecutionOrder (队列等待，默认方式)</code> 和 <code>SDWebImageDownloaderLIFOExecutionOrder (栈等待)</code></li>
</ul>
<p><code>Downloader</code>实现<code>NSURLSessionDataDelegate</code>协议，并将回调派发给具体的<code>DownloaderOperation</code>来响应下载各个阶段的数据回调。</p>
<p><code>DownloaderOperation</code>继承自<code>NSOperation</code>并实现<code>SDWebImageOperation</code>。都是为了保证下载任务能被<code>cancel</code>。<code>cancel</code>对应一个任务而言是很重要的。因为继承自<code>NSOperation</code>，所以SD在cancel部分的实现也很简单。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">- (void)cancel &#123;</span><br><span class="line">    @synchronized (self) &#123;</span><br><span class="line">        if (self.thread) &#123;</span><br><span class="line">            [self performSelector:@selector(cancelInternalAndStop) onThread:self.thread withObject:nil waitUntilDone:NO];</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            [self cancelInternal];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)cancelInternalAndStop &#123;</span><br><span class="line">    if (self.isFinished) return;</span><br><span class="line">    [self cancelInternal];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)cancelInternal &#123;</span><br><span class="line">    if (self.isFinished) return;</span><br><span class="line">    [super cancel];</span><br><span class="line">    if (self.cancelBlock) self.cancelBlock();</span><br><span class="line"></span><br><span class="line">    if (self.dataTask) &#123;</span><br><span class="line">        [self.dataTask cancel];</span><br><span class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            [[NSNotificationCenter defaultCenter] postNotificationName:SDWebImageDownloadStopNotification object:self];</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // As we cancelled the connection, its callback won&apos;t be called and thus won&apos;t</span><br><span class="line">        // maintain the isFinished and isExecuting flags.</span><br><span class="line">        if (self.isExecuting) self.executing = NO;</span><br><span class="line">        if (!self.isFinished) self.finished = YES;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [self reset];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>保证<code>cancel</code>操作的原子性，调用<code>[super cancel]</code> 和 将内置的<code>[self.dataTask cancel]</code>。重置一些状态位即可。 </p>
<p>SD的下载逻辑实现还是写的比较精彩的。清晰和严谨，不愧是“久经考验”</p>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>SD还有<code>SDWebImagePrefetcher</code>模块。顾名思义，<code>Prefetcher</code>就是预下载逻辑。提前拉取图片资源，等到用的时候直接取用本地资源。<code>本地IO</code>速度快于<code>网络IO</code>，是一种优化思路。</p>
<p>查看SD源码时，一些查阅的链接。 有些启发，在这里记录一下。</p>
<p><a href="https://developer.apple.com/library/content/documentation/GraphicsImaging/Conceptual/ImageIOGuide/imageio_intro/ikpg_intro.html#//apple_ref/doc/uid/TP40005462-CH201-TPXREF101" target="_blank" rel="external">Image I/O Programming Guide</a></p>
<p><a href="http://www.fantageek.com/2015/06/18/understanding-sdwebimage-decompression/" target="_blank" rel="external">Understanding SDWebImage - Decompression</a></p>
<p><a href="http://pulkitgoyal.in/resizing-high-resolution-images-on-ios-without-memory-issues/" target="_blank" rel="external">Resizing High Resolution Images on iOS Without Memory Issues</a></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SDWebImage/">SDWebImage</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2016-09-01-iOS 包瘦身研究" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/01/2016-09-01-iOS 包瘦身研究/">iOS 包瘦身浅析</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/09/01/2016-09-01-iOS 包瘦身研究/" class="article-date">
  <time datetime="2016-09-01T00:00:00.000Z" itemprop="datePublished">2016-09-01</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="为什么要做包瘦身"><a href="#为什么要做包瘦身" class="headerlink" title="为什么要做包瘦身?"></a>为什么要做包瘦身?</h2><blockquote>
<p>Your app’s total uncompressed size must be less than 4 billion bytes. Each Mach-O executable file (for example, app_name.app/app_name) must not exceed these limits:</p>
<p>For apps whose MinimumOSVersion is less than 7.0: maximum of 80 MB for the total of all __TEXT sections in the binary.</p>
<p>For apps whose MinimumOSVersion is 7.x through 8.x: maximum of 60 MB per slice for the __TEXT section of each architecture slice in the binary.</p>
<p>For apps whose MinimumOSVersion is 9.0 or greater: maximum of 400 MB for the size of the Mach-O binary file.</p>
</blockquote>
<p><strong> Apple 对上架App 是有包大小限制的。超过这个限制，是无法提交审核的。 </strong></p>
<blockquote>
<p>However, consider download times when determining your app’s size. Minimize the file’s size as much as possible, keeping in mind that there is a 100 MB limit for over-the-air downloads.</p>
</blockquote>
<p><strong> 尽可能控制包大小， 超过100MB的App 是不会被自动更新到用户手机上 </strong></p>
<h2 id="如何分析可执行文件的大小"><a href="#如何分析可执行文件的大小" class="headerlink" title="如何分析可执行文件的大小"></a>如何分析可执行文件的大小</h2><p>AppStore 上传的包大小 =  资源文件大小 + 可执行文件大小</p>
<p>资源文件大小 显而易见。 但可执行文件由 具体的(.h/.m/.swift)文件编译链接而成。这个光是看代码文件大小是衡量不出来的。</p>
<p>这个时候就要介绍一下LinkMap了。 Xcode的LinkMap文件。LinkMap文件是Xcode产生可执行文件的同时生成的链接信息，用来描述可执行文件的构造成分，包括代码段<code>__TEXT</code>和数据段<code>__DATA</code>的分布情况。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># Sections:</span><br><span class="line"># Address	Size    	Segment	Section</span><br><span class="line">0x100002680	0x02DAED20	__TEXT	__text</span><br><span class="line">0x102DB13A0	0x00002FAC	__TEXT	__stubs</span><br><span class="line">0x102DB434C	0x00004DC2	__TEXT	__stub_helper</span><br><span class="line">0x102DB9110	0x00172C10	__TEXT	__gcc_except_tab</span><br><span class="line">0x102F2BD20	0x001DC91A	__TEXT	__objc_methname</span><br><span class="line">0x10310863A	0x00039CC2	__TEXT	__objc_classname</span><br><span class="line">0x1031422FC	0x00057D8E	__TEXT	__objc_methtype</span><br><span class="line">0x10319A090	0x00229C39	__TEXT	__cstring</span><br><span class="line">0x1033C3CD0	0x00025194	__TEXT	__ustring</span><br><span class="line">0x1033E8E80	0x000CC108	__TEXT	__const</span><br><span class="line">0x1034B4F88	0x000002C0	__TEXT	__swift2_proto</span><br><span class="line">0x1034B5248	0x000003E6	__TEXT	__entitlements</span><br><span class="line">0x1034B5630	0x00099AC8	__TEXT	__unwind_info</span><br><span class="line">0x10354F0F8	0x000AAED0	__TEXT	__eh_frame</span><br><span class="line">0x1035FA000	0x00000010	__DATA	__nl_symbol_ptr</span><br><span class="line">0x1035FA010	0x00002558	__DATA	__got</span><br><span class="line">0x1035FC568	0x00003F90	__DATA	__la_symbol_ptr</span><br><span class="line">0x1036004F8	0x000002E0	__DATA	__mod_init_func</span><br><span class="line">0x1036007E0	0x00103990	__DATA	__const</span><br><span class="line">0x103704170	0x00123460	__DATA	__cfstring</span><br><span class="line">0x1038275D0	0x00012130	__DATA	__objc_classlist</span><br><span class="line">0x103839700	0x00000328	__DATA	__objc_nlclslist</span><br><span class="line">0x103839A28	0x000016A8	__DATA	__objc_catlist</span><br><span class="line">0x10383B0D0	0x00000128	__DATA	__objc_nlcatlist</span><br><span class="line">0x10383B1F8	0x00002B68	__DATA	__objc_protolist</span><br><span class="line">0x10383DD60	0x00000008	__DATA	__objc_imageinfo</span><br><span class="line">0x10383DD68	0x009AECA8	__DATA	__objc_const</span><br><span class="line">0x1041ECA10	0x00074B98	__DATA	__objc_selrefs</span><br><span class="line">0x1042615A8	0x00000A60	__DATA	__objc_protorefs</span><br><span class="line">0x104262008	0x0000EFE8	__DATA	__objc_classrefs</span><br><span class="line">0x104270FF0	0x0000B490	__DATA	__objc_superrefs</span><br><span class="line">0x10427C480	0x00050BD0	__DATA	__objc_ivar</span><br><span class="line">0x1042CD050	0x000B6010	__DATA	__objc_data</span><br><span class="line">0x104383060	0x000C0CA0	__DATA	__data</span><br><span class="line">0x104443D00	0x00143220	__DATA	__common</span><br><span class="line">0x104586F40	0x0013DAC0	__DATA	__bss</span><br></pre></td></tr></table></figure>
<p>可执行文件大小 = 末位地址(0x104586F40) + size(0x0013DAC0) -  起始地址(0x100002680)。 <strong> 注意是16进制 </strong></p>
<p>详细的 LinkMap 是 这么几部分组成：</p>
<ol>
<li><p>Object files 所编译项目中的所有.obj文件及文件编号</p>
</li>
<li><p>Sections 可执行文件的段表，描述各个段在可执行文件中的偏移位置和大小</p>
</li>
<li><p>Symbols 详细描述各个.obj文件在段表中的分布情况。 可以计算出每个obj文件的占用大小，进而算出每个静态库、功能模块代码占用大小。</p>
</li>
</ol>
<h2 id="官方-Q-amp-A"><a href="#官方-Q-amp-A" class="headerlink" title="官方 Q&amp;A"></a>官方 Q&amp;A</h2><ul>
<li><p><a href="https://developer.apple.com/library/ios/qa/qa1795/_index.html" target="_blank" rel="external">Technical Q&amp;A QA1795 Reducing the size of my App</a></p>
</li>
<li><p><a href="https://developer.apple.com/library/mac/documentation/DeveloperTools/Conceptual/MachORuntime/" target="_blank" rel="external">OS X ABI Mach-O File Format Reference</a></p>
</li>
</ul>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2016-08-13-如何将App 装载到模拟器中" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/13/2016-08-13-如何将App 装载到模拟器中/">如何将App装载到模拟器</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/08/13/2016-08-13-如何将App 装载到模拟器中/" class="article-date">
  <time datetime="2016-08-13T00:00:00.000Z" itemprop="datePublished">2016-08-13</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a><span>></span><a class="article-category-link" href="/categories/iOS/Simulator/">Simulator</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>笔者这里使用 <a href="https://itunes.apple.com/cn/app/nice-hao-zan-fa-zhao-pian/id641895599?mt=8" target="_blank" rel="external">nice</a> 这款App 演示。</p>
<h2 id="step-1"><a href="#step-1" class="headerlink" title="step 1"></a>step 1</h2><p>首先使用Mac iTunes下载 对应App的ipa包，再解压，在Payload目录下 我们发现nice这款app的真身： KKShopping.app(难道nice也有一颗电商的心吗？)</p>
<p>使用 <code>xcrun simctl list</code> 查看现有的设备列表。</p>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/xcrun-simctl-list.png" alt="xcrun-simctl-list"></p>
<h2 id="step-2"><a href="#step-2" class="headerlink" title="step 2"></a>step 2</h2><p>创建新的模拟器，笔者这里创建iPhone 6搭载iOS9.3系统. 命名为MyiPhone6</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun simctl create &quot;MyiPhone6&quot; &quot;iPhone 6&quot; &quot;com.apple.CoreSimulator.SimRuntime.iOS-9-3&quot;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/simctl-create.png" alt="simctl-create"></p>
<h2 id="step-3"><a href="#step-3" class="headerlink" title="step 3"></a>step 3</h2><p>唤起MyiPhone6， 使用Xcode Simulator.app 唤起，参数CurrentDeviceUDID选择我们在<code>xcrun simctl list</code> Devices下看到的MyiPhone6的udid。 <strong>注意</strong> 一定要唤起，模拟器在shutdown state下是装载不了App的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open -n /Applications/Xcode.app/Contents/Developer/Applications/Simulator.app --args -CurrentDeviceUDID &apos;2C630172-AF2B-4798-B854-3FEE5F221411&apos;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/xcrun-simctl-list1.png" alt="xcrun-simctl-list1"></p>
<h2 id="step-4"><a href="#step-4" class="headerlink" title="step 4"></a>step 4</h2><p>装载 KKShopping.app</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun simctl install MyiPhone6 ~/Music/iTunes/iTunes\ Media/Mobile\ Applications/nice\ 4.0.0/Payload/KKShopping.app</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/install-nice-app.png" alt="install-nice-app"></p>
<p>如果，你按照步骤做完之后。 点击模拟器中的nice图标，发现它闪退了。</p>
<p>这里有一个原因是 我们通过iTunes下载下来的包要求运行环境是手机。 而手机和电脑模拟器的CPU架构是不一致的，所以运行不了很正常。</p>
<p>如果，你有源码编译出的<code>Release-iphonesimulator</code>目录下的app文件。 可以试一下下面的命令，在模拟器中唤起你的app</p>
<h2 id="step-5"><a href="#step-5" class="headerlink" title="step 5"></a>step 5</h2><p>唤起模拟器中的App<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun simctl launch booted your.app.bundle_Identifier</span><br></pre></td></tr></table></figure></p>
<p>唤起时，可以额外设置参数进去<br><code>xcrun simctl launch booted your.app.bundle_Identifier -port 7001</code></p>
<p>对应<code>iOS</code>中的读取逻辑代码为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[[[NSUserDefaults standardUserDefaults] dictionaryRepresentation] enumerateKeysAndObjectsUsingBlock:^(NSString * _Nonnull key, id  _Nonnull obj, BOOL * _Nonnull stop) &#123;</span><br><span class="line">    if([key isEqualToString:@&quot;port&quot;])&#123;</span><br><span class="line">        port = obj;</span><br><span class="line">        *stop = YES;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">// port = 7001</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS-Simulator/">iOS Simulator</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2016-05-28-Word Search II" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/28/2016-05-28-Word Search II/">Word Search II</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/05/28/2016-05-28-Word Search II/" class="article-date">
  <time datetime="2016-05-28T00:00:00.000Z" itemprop="datePublished">2016-05-28</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a><span>></span><a class="article-category-link" href="/categories/Algorithm/LeetCode/">LeetCode</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://leetcode.com/problems/word-search-ii/" target="_blank" rel="external">Word Search</a></p>
<blockquote>
<p>Given a 2D board and a list of words from the dictionary, find all words in the board.</p>
<p>Each word must be constructed from letters of sequentially adjacent cell, where “adjacent” cells are those horizontally or vertically neighboring. The same letter cell may not be used more than once in a word.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">For example,</span><br><span class="line">Given words = [&quot;oath&quot;,&quot;pea&quot;,&quot;eat&quot;,&quot;rain&quot;] and board =</span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">  [&apos;o&apos;,&apos;a&apos;,&apos;a&apos;,&apos;n&apos;],</span><br><span class="line">  [&apos;e&apos;,&apos;t&apos;,&apos;a&apos;,&apos;e&apos;],</span><br><span class="line">  [&apos;i&apos;,&apos;h&apos;,&apos;k&apos;,&apos;r&apos;],</span><br><span class="line">  [&apos;i&apos;,&apos;f&apos;,&apos;l&apos;,&apos;v&apos;]</span><br><span class="line">]</span><br><span class="line">Return [&quot;eat&quot;,&quot;oath&quot;].</span><br></pre></td></tr></table></figure>
<p>题目大意：给定一个二维面板和一组字符串，找出二维面板上存在的字符串。<br><strong>必须使用面板上的字母且水平连续或垂直连续拼接单词。</strong></p>
<h2 id="思路1：-深度优先搜索-DFS-Time-Limit-Exceeded"><a href="#思路1：-深度优先搜索-DFS-Time-Limit-Exceeded" class="headerlink" title="思路1： 深度优先搜索(DFS)  Time Limit Exceeded"></a>思路1： 深度优先搜索(DFS)  <span style="color:red">Time Limit Exceeded</span></h2><p>先遍历每个单词，如果单词首字母面板上有存在则开始深度优先搜索单词剩余的字母。</p>
<p>来分析一下超时的Test Case：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[&quot;aaaa&quot;,&quot;aaaa&quot;,&quot;aaaa&quot;,&quot;aaaa&quot;,&quot;bcde&quot;,&quot;fghi&quot;,&quot;jklm&quot;,&quot;nopq&quot;,&quot;rstu&quot;,&quot;vwxy&quot;,&quot;zzzz&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[&quot;aaaaaaaaaaaaaaaa&quot;,&quot;aaaaaaaaaaaaaaab&quot;,&quot;aaaaaaaaaaaaaaac&quot;,&quot;aaaaaaaaaaaaaaad&quot;,&quot;aaaaaaaaaaaaaaae&quot;,&quot;aaaaaaaaaaaaaaaf&quot;,&quot;aaaaaaaaaaaaaaag&quot;,&quot;aaaaaaaaaaaaaaah&quot;,&quot;aaaaaaaaaaaaaaai&quot;,&quot;aaaaaaaaaaaaaaaj&quot;,&quot;aaaaaaaaaaaaaaak&quot;,&quot;aaaaaaaaaaaaaaal&quot;,&quot;aaaaaaaaaaaaaaam&quot;,&quot;aaaaaaaaaaaaaaan&quot;,&quot;aaaaaaaaaaaaaaao&quot;,&quot;aaaaaaaaaaaaaaap&quot;,&quot;aaaaaaaaaaaaaaaq&quot;,&quot;aaaaaaaaaaaaaaar&quot;,&quot;aaaaaaaaaaaaaaas&quot;,&quot;aaaaaaaaaaaaaaat&quot;,&quot;aaaaaaaaaaaaaaau&quot;,&quot;aaaaaaaaaaaaaaav&quot;,&quot;aaaaaaaaaaaaaaaw&quot;,&quot;aaaaaaaaaaaaaaax&quot;,&quot;aaaaaaaaaaaaaaay&quot;,&quot;aaaaaaaaaaaaaaaz&quot;,&quot;aaaaaaaaaaaaaaaa&quot;,&quot;aaaaaaaaaaaaaaab&quot;,&quot;aaaaaaaaaaaaaaac&quot;,&quot;aaaaaaaaaaaaaaad&quot;,&quot;aaaaaaaaaaaaaaae&quot;,&quot;aaaaaaaaaaaaaaaf&quot;,&quot;aaaaaaaaaaaaaaag&quot;,&quot;aaaaaaaaaaaaaaah&quot;,&quot;aaaaaaaaaaaaaaai&quot;,&quot;aaaaaaaaaaaaaaaj&quot;,&quot;aaaaaaaaaaaaaaak&quot;,&quot;aaaaaaaaaaaaaaal&quot;,&quot;aaaaaaaaaaaaaaam&quot;,&quot;aaaaaaaaaaaaaaan&quot;,&quot;aaaaaaaaaaaaaaao&quot;,&quot;aaaaaaaaaaaaaaap&quot;,&quot;aaaaaaaaaaaaaaaq&quot;,&quot;aaaaaaaaaaaaaaar&quot;,&quot;aaaaaaaaaaaaaaas&quot;,&quot;aaaaaaaaaaaaaaat&quot;,&quot;aaaaaaaaaaaaaaau&quot;,&quot;aaaaaaaaaaaaaaav&quot;,&quot;aaaaaaaaaaaaaaaw&quot;,&quot;aaaaaaaaaaaaaaax&quot;,&quot;aaaaaaaaaaaaaaay&quot;,&quot;aaaaaaaaaaaaaaaz&quot;,&quot;aaaaaaaaaaaaaaba&quot;,&quot;aaaaaaaaaaaaaabb&quot;,&quot;aaaaaaaaaaaaaabc&quot;]</span><br></pre></td></tr></table></figure>
<p>发现这个Test Case很有意思，有大量重复相同的前缀<code>aaaaaaaaaaaaaaaa</code>。使用DFS遍历图的话，如果没有高效的剪枝策略。光是这个前缀的深度优先搜索效率就很低下了。</p>
<h2 id="思路2-：-字典树-Trie-深度优先搜索-DFS-Accepted"><a href="#思路2-：-字典树-Trie-深度优先搜索-DFS-Accepted" class="headerlink" title="思路2 ： 字典树(Trie) + 深度优先搜索(DFS) Accepted"></a>思路2 ： 字典树(Trie) + 深度优先搜索(DFS) <span style="color:green">Accepted</span></h2><p>建立Trie字典树，能有效的避免大量重复前缀的搜索。 </p>
<p>LeetCodeOJ 上有<a href="https://leetcode.com/problems/implement-trie-prefix-tree/" target="_blank" rel="external">关于Trie建树的题目</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">const int TrieChildNodeMax(26);</span><br><span class="line">class Trie&#123;</span><br><span class="line">public:</span><br><span class="line">    class TrieNode&#123;</span><br><span class="line">    public:</span><br><span class="line">        TrieNode()&#123;</span><br><span class="line">            isWord = false;</span><br><span class="line">            word = &quot;&quot;;</span><br><span class="line">            memset(childNode, NULL, sizeof(TrieNode *) * TrieChildNodeMax);</span><br><span class="line">        &#125;</span><br><span class="line">        TrieNode *childNode[TrieChildNodeMax];</span><br><span class="line">        string word;</span><br><span class="line">        bool isWord;</span><br><span class="line">    &#125;;</span><br><span class="line">    TrieNode *root;</span><br><span class="line">    </span><br><span class="line">    Trie()&#123;</span><br><span class="line">        root = new TrieNode();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    void insert(const string word,TrieNode* node,int idx = 0)&#123;</span><br><span class="line">        if(idx == word.length()) return ;</span><br><span class="line">        int k = word[idx] - &apos;a&apos;;</span><br><span class="line">        if(node-&gt;childNode[k] == NULL)&#123;</span><br><span class="line">            node-&gt;childNode[k] = new TrieNode();</span><br><span class="line">        &#125;</span><br><span class="line">        if(idx == word.length() - 1)&#123;</span><br><span class="line">            node-&gt;childNode[k]-&gt;isWord = true;</span><br><span class="line">            node-&gt;childNode[k]-&gt;word = word;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            insert(word, node-&gt;childNode[k],idx+1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">class Solution &#123;</span><br><span class="line">public:</span><br><span class="line">    vector&lt;string&gt; findWords(vector&lt;vector&lt;char&gt;&gt;&amp; board, vector&lt;string&gt;&amp; words) &#123;</span><br><span class="line">        vector&lt;string&gt; ans;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        for_each(words.begin(), words.end(), [&amp;](const string word)&#123;</span><br><span class="line">            trie.insert(word, trie.root);</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        n = (int)board.size();</span><br><span class="line">        m = 0;</span><br><span class="line">        if(n &gt; 0) m = (int)board[0].size();</span><br><span class="line">        </span><br><span class="line">        for(int i=0;i&lt;n;i++)&#123;</span><br><span class="line">            for(int j=0;j&lt;m;j++)&#123;</span><br><span class="line">                memset(vis, false, sizeof(bool)*1024*1024);</span><br><span class="line">                if(boardHasWord(board,i,j,trie.root,ans))&#123;</span><br><span class="line">                    cout&lt;&lt;&quot;Yes,find word in borad&quot;&lt;&lt;endl;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        sort(ans.begin(), ans.end());</span><br><span class="line">        </span><br><span class="line">        return ans;</span><br><span class="line">    &#125;</span><br><span class="line">private:</span><br><span class="line">    bool judge(const int x,const int y)&#123;</span><br><span class="line">        return (x&gt;-1&amp;&amp;x&lt;n&amp;&amp;y&gt;-1&amp;&amp;y&lt;m&amp;&amp;!vis[x][y]);</span><br><span class="line">    &#125;</span><br><span class="line">    bool boardHasWord(const vector&lt;vector&lt;char&gt;&gt; board,int x,int y,Trie::TrieNode* root,vector&lt;string&gt;&amp; ans)&#123;</span><br><span class="line">        int k = board[x][y] - &apos;a&apos;;</span><br><span class="line">        vis[x][y] = true;</span><br><span class="line">        if(root-&gt;childNode[k])&#123;</span><br><span class="line">            if(root-&gt;childNode[k]-&gt;isWord)&#123;</span><br><span class="line">                root-&gt;childNode[k]-&gt;isWord = false;</span><br><span class="line">                ans.push_back(root-&gt;childNode[k]-&gt;word);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            for(int i=0;i&lt;4;i++)&#123;</span><br><span class="line">                int xx = x + dir[i][0];</span><br><span class="line">                int yy = y + dir[i][1];</span><br><span class="line">                </span><br><span class="line">                if(judge(xx, yy))&#123;</span><br><span class="line">                    vis[xx][yy] = true;</span><br><span class="line">                    if(boardHasWord(board, xx, yy, root-&gt;childNode[k], ans)) return true;</span><br><span class="line">                    vis[xx][yy] = false;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    int n,m;</span><br><span class="line">    const int dir[4][2] = &#123; &#123;1,0&#125;,&#123;0,1&#125;,&#123;-1,0&#125;,&#123;0,-1&#125; &#125;;</span><br><span class="line">    bool vis[1024][1024];</span><br><span class="line">    Trie trie;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">    </span><br><span class="line">    freopen(INPUT,&quot;r&quot;,stdin);</span><br><span class="line">    </span><br><span class="line">    string buf;</span><br><span class="line">    vector&lt;vector&lt;char&gt;&gt; board;</span><br><span class="line">    while(cin&gt;&gt;buf)&#123;</span><br><span class="line">        vector&lt;char&gt; chars;</span><br><span class="line">        chars.assign(buf.begin(), buf.end());</span><br><span class="line">        board.push_back(chars);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    Solution solve;</span><br><span class="line">    vector&lt;string&gt; words(&#123;&quot;aaaaaaaaaaaaaaaa&quot;,&quot;aaaaaaaaaaaaaaab&quot;,&quot;aaaaaaaaaaaaaaac&quot;,&quot;aaaaaaaaaaaaaaad&quot;&#125;);</span><br><span class="line">    vector&lt;string&gt; ans = solve.findWords(board,words);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    for_each(ans.begin(), ans.end(), [](const string str)&#123;</span><br><span class="line">        cout&lt;&lt;str&lt;&lt;endl;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/*	Wrong Answer */</span><br><span class="line">/*</span><br><span class="line">[&quot;ab&quot;,&quot;aa&quot;]</span><br><span class="line">[&quot;aba&quot;,&quot;baa&quot;,&quot;bab&quot;,&quot;aaab&quot;,&quot;aaa&quot;,&quot;aaaa&quot;,&quot;aaba&quot;]</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/* Time Limit Exceeded */</span><br><span class="line">/*</span><br><span class="line"> </span><br><span class="line"> [&quot;aaaa&quot;,&quot;aaaa&quot;,&quot;aaaa&quot;,&quot;aaaa&quot;,&quot;bcde&quot;,&quot;fghi&quot;,&quot;jklm&quot;,&quot;nopq&quot;,&quot;rstu&quot;,&quot;vwxy&quot;,&quot;zzzz&quot;]</span><br><span class="line"> [&quot;aaaaaaaaaaaaaaaa&quot;,&quot;aaaaaaaaaaaaaaab&quot;,&quot;aaaaaaaaaaaaaaac&quot;,&quot;aaaaaaaaaaaaaaad&quot;]</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/Word_Search_II.png" alt="Accepted"></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LeetCode/">LeetCode</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2016-04-25-House Robber" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/25/2016-04-25-House Robber/">House Robber</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/04/25/2016-04-25-House Robber/" class="article-date">
  <time datetime="2016-04-25T00:00:00.000Z" itemprop="datePublished">2016-04-25</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a><span>></span><a class="article-category-link" href="/categories/Algorithm/LeetCode/">LeetCode</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://leetcode.com/problems/house-robber/" target="_blank" rel="external">House Robber</a></p>
<blockquote>
<p>You are a professional robber planning to rob houses along a street. Each house has a certain amount of money stashed, the only constraint stopping you from robbing each of them is that adjacent houses have security system connected and it will automatically contact the police if two adjacent houses were broken into on the same night.</p>
<p>Given a list of non-negative integers representing the amount of money of each house, determine the maximum amount of money you can rob tonight without alerting the police.</p>
</blockquote>
<p>题目大意：你是一个职业强盗，计划去洗劫一条街。这条街上每个店铺都有一定量的现金。但是如果两家相邻的店铺被同时打劫的话会惊动警察。给定一个非负数数组表示各个店铺的现金数，请制定一个合理的打劫顺序使今晚的洗劫行动收获最大。</p>
<p>思考： </p>
<ol>
<li><strong>贪心策略</strong>：只洗劫奇数店铺 或 偶数店铺。 但细想一下，该策略只适合店铺数少于4的情况。比如有4家店铺的话： Plans = {[1,3],[2,4],[1,4]}；贪心策略的一个反例。</li>
<li><strong>暴力搜索</strong>：深度搜索，枚举每个店铺的两种状态： 抢 或 不抢。抢依赖上一家不抢。类似01背包，背包没有容量限制。<strong>可能会超时</strong></li>
<li>在想 思路2的时候，其实已经想到这是一个 动态规划的题了：）动规的时间复杂度比搜索要来的线性，稳定。动态方程式是 <code>dp[i] = max{dp[i-2]+nums[i],dp[i-1]} 2&lt;=i&lt;numsSize</code></li>
</ol>
<h2 id="动态规划-Accepted"><a href="#动态规划-Accepted" class="headerlink" title="动态规划 Accepted"></a>动态规划 <span style="color:green;">Accepted</span></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> a,<span class="keyword">const</span> <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a &gt; b ? a : b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">easyRob</span><span class="params">(<span class="keyword">int</span>* nums, <span class="keyword">int</span> numsSize)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> odd = <span class="number">0</span>, eve = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;numsSize;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i%<span class="number">2</span>) eve += nums[i];</span><br><span class="line">        <span class="keyword">else</span> odd += nums[i];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> max(odd,eve);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">rob</span><span class="params">(<span class="keyword">int</span>* nums, <span class="keyword">int</span> numsSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(numsSize &lt;= <span class="number">3</span>) <span class="keyword">return</span> easyRob(nums,numsSize);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> *dp = (<span class="keyword">int</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*(numsSize));</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>)*(numsSize));</span><br><span class="line">    dp[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">    dp[<span class="number">1</span>] = max(nums[<span class="number">1</span>],nums[<span class="number">0</span>]);</span><br><span class="line">    dp[<span class="number">2</span>] = max(dp[<span class="number">0</span>]+nums[<span class="number">2</span>],dp[<span class="number">1</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;numsSize;i++)&#123;</span><br><span class="line">        dp[i] = max(dp[i<span class="number">-2</span>]+nums[i],dp[i<span class="number">-1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> ans = dp[numsSize<span class="number">-1</span>];</span><br><span class="line">    <span class="built_in">free</span>(dp);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/house_robber.png" alt=""></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LeetCode/">LeetCode</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2016-04-08-Minimum Size Subarray Sum" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/08/2016-04-08-Minimum Size Subarray Sum/">Minimum Size Subarray Sum</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/04/08/2016-04-08-Minimum Size Subarray Sum/" class="article-date">
  <time datetime="2016-04-08T00:00:00.000Z" itemprop="datePublished">2016-04-08</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a><span>></span><a class="article-category-link" href="/categories/Algorithm/LeetCode/">LeetCode</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://leetcode.com/problems/minimum-size-subarray-sum/" target="_blank" rel="external">Minimum Size Subarray Sum</a></p>
<blockquote>
<p>Given an array of n positive integers and a positive integer s, find the minimal length of a subarray of which the sum ≥ s. If there isn’t one, return 0 instead.</p>
<p>For example, given the array [2,3,1,2,4,3] and s = 7,<br>the subarray [4,3] has the minimal length under the problem constraint.</p>
</blockquote>
<p>题目大意： 给定一个正数数组 nums和一个正数 s，找出最短长度的连续子数组 使其和 大于等于 s。如果没有的话，返回 0.</p>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><h2 id="暴力枚举-Accepted"><a href="#暴力枚举-Accepted" class="headerlink" title="暴力枚举 Accepted"></a>暴力枚举 <span style="color:green;">Accepted</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">public:</span><br><span class="line">    int minSubArrayLen(int s, vector&lt;int&gt;&amp; nums) &#123;</span><br><span class="line">        size_t n = nums.size();</span><br><span class="line">        int sum = 0;</span><br><span class="line">        int ans = INT_MAX;</span><br><span class="line">        for(int i=0;i&lt;n;i++)&#123;</span><br><span class="line">            sum = nums[i];</span><br><span class="line">            if(sum &gt;= s) return 1;</span><br><span class="line">            for(int j=i+1;j&lt;n;j++)&#123;</span><br><span class="line">                sum += nums[j];</span><br><span class="line">                if(sum &gt;= s)&#123;</span><br><span class="line">                    ans = min(ans,j-i+1);</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        return ans==INT_MAX ? 0 : ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/Minimum%20Size%20Subarray%20Sum.png" alt=""></p>
<h2 id="暴力枚举-flag优化-Accepted"><a href="#暴力枚举-flag优化-Accepted" class="headerlink" title="暴力枚举 + flag优化 Accepted"></a>暴力枚举 + flag优化 <span style="color:green;">Accepted</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">public:</span><br><span class="line">    int minSubArrayLen(int s, vector&lt;int&gt;&amp; nums) &#123;</span><br><span class="line">        size_t n = nums.size();</span><br><span class="line">        int sum = 0;</span><br><span class="line">        int ans = INT_MAX;</span><br><span class="line">        </span><br><span class="line">        bool flag;</span><br><span class="line">        for(int i=0;i&lt;n;i++)&#123;</span><br><span class="line">            sum = nums[i];</span><br><span class="line">            if(sum &gt;= s) return 1;</span><br><span class="line">            flag = false;</span><br><span class="line">            for(int j=i+1;j&lt;n;j++)&#123;</span><br><span class="line">                sum += nums[j];</span><br><span class="line">                if(sum &gt;= s)&#123;</span><br><span class="line">                    ans = min(ans,j-i+1);</span><br><span class="line">                    flag = true;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            if(!flag) break;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        return ans==INT_MAX ? 0 : ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/Minimum%20Size%20Subarray%20Sum%202.png" alt=""></p>
<h2 id="枚举小窗口-Accepted"><a href="#枚举小窗口-Accepted" class="headerlink" title="枚举小窗口 Accepted"></a>枚举小窗口 <span style="color:green;">Accepted</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">public:</span><br><span class="line">    int minSubArrayLen(int s, vector&lt;int&gt;&amp; nums) &#123;</span><br><span class="line">        size_t n = nums.size();</span><br><span class="line">        int sum = 0;</span><br><span class="line">        int ans = INT_MAX;</span><br><span class="line">        int p = 0,q = 0;</span><br><span class="line">        </span><br><span class="line">        while(q &lt; n)&#123;</span><br><span class="line">            sum += nums[q++];</span><br><span class="line">            </span><br><span class="line">            while(sum &gt;= s)&#123;</span><br><span class="line">                ans = min(ans,q-p);</span><br><span class="line">                sum -= nums[p++];</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        return ans==INT_MAX ? 0 : ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/Minimum%20Size%20Subarray%20Sum%203.png" alt=""></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LeetCode/">LeetCode</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2016-03-30-Cocoa Auto Update" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/30/2016-03-30-Cocoa Auto Update/">Cocoa Auto Update</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/03/30/2016-03-30-Cocoa Auto Update/" class="article-date">
  <time datetime="2016-03-30T00:00:00.000Z" itemprop="datePublished">2016-03-30</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/OS-X/">OS X</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Cocoa-auto-update"><a href="#Cocoa-auto-update" class="headerlink" title="Cocoa auto update"></a>Cocoa auto update</h1><p>我们在进行Mac 桌面应用开发的时候，需要维护应用的更新。我们希望说每一次的新版本发布,用户都能够自动更新下载版本并且替换掉老版本。</p>
<p>首先需要一个文件服务器来存放 对外发布的软件压缩包。这里还维护一份releaseInfo.json对外描述已有的版本信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;app&quot;: &quot;MyApp&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;channels&quot;: [&quot;release&quot;],</span><br><span class="line">  &quot;entries&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;os&quot;: &quot;osx&quot;,</span><br><span class="line">      &quot;architectures&quot;: [&quot;x86-64&quot;],</span><br><span class="line">      &quot;osversion&quot;: &quot; &gt;= 10.6 &quot;,</span><br><span class="line">      &quot;appversion&quot;: &quot;1.0.0&quot;,</span><br><span class="line">      &quot;path&quot;: &quot;MyApp-1.0.0-osx.tar.gz&quot;,</span><br><span class="line">      &quot;format&quot;: &quot;gz&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>客户端定时check版本信息，发现服务端有版本号大于自身版本号的时候 触发更新下载逻辑。 这里使用<code>NSURLSession</code>即可，下载过程不在这里描述了。</p>
<p>当我们自行下载完安装包之后，如何帮助用户自动安装呢?</p>
<p>我们下载完成之后，可用使用<code>NSTask</code>来调用一个 shell 脚本，让它来帮助我们结束老版本的进程，同时将下载好的新版本解压、拷贝内容到老版本的路径下、重新唤起App。 这个时候，app运行就是新版本的样式和逻辑</p>
<p>附上具体的shell脚本：</p>
<p><strong>注意需要传入的参数：tarball指的下载的安装包路径，destination指的当前app的bundlePath</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">function abort() &#123;</span><br><span class="line">    echo &quot;Update script aborted.&quot;</span><br><span class="line">    echo &quot;Removing temporary directory...&quot;</span><br><span class="line">    rm -rf $tempdir</span><br><span class="line">    echo &quot;Removing tarball...&quot;</span><br><span class="line">    rm -rf &quot;$tarball&quot;</span><br><span class="line">    echo &quot;Relaunching bundle...&quot;</span><br><span class="line">    open &quot;$destination&quot;</span><br><span class="line">    rm -f ~/.auto-update.lock</span><br><span class="line">    exit 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tarball=$1</span><br><span class="line">destination=$2</span><br><span class="line"></span><br><span class="line">lockfile ~/.auto-update.lock</span><br><span class="line"></span><br><span class="line"># Step 1. Wait until all processes from within the bundle are closed</span><br><span class="line"></span><br><span class="line">processes=$(echo &quot;$(ps ax)&quot; | grep -v &quot;$0&quot;)</span><br><span class="line"># Escape the destination into a regexp that matches it</span><br><span class="line">regexp=$(echo &quot;$destination&quot; | sed &apos;s/[^[:alnum:]_-]/\\&amp;/g&apos;)</span><br><span class="line"># Filters entries matching the regexp, and do some magic to preserve the trailing newline</span><br><span class="line">matches=$(echo &quot;$processes&quot; | awk &quot;/$regexp/ &#123; print \$1 &#125;&quot;; echo .)</span><br><span class="line">matches=$&#123;matches%.&#125;</span><br><span class="line"># Count matches</span><br><span class="line">count=`printf &quot;%s&quot; &quot;$matches&quot; | wc -l`</span><br><span class="line">if [[ $count -gt 0 ]]; then</span><br><span class="line">    for pid in $matches</span><br><span class="line">    do</span><br><span class="line">        echo &quot;$pid&quot;</span><br><span class="line">        kill -9 &quot;$pid&quot;</span><br><span class="line">    done</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Step 2. Check if the downloaded tar is empty, if so abort</span><br><span class="line">if [ ! -s &quot;$tarball&quot; ]</span><br><span class="line">then</span><br><span class="line">    abort</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"># Step 3. Extract the new contents</span><br><span class="line">echo &quot;Creating temporary directory...&quot;</span><br><span class="line">tempdir=`mktemp -d /tmp/auto-update.XXXXX`</span><br><span class="line">echo &quot;Extracting new content from tarball...&quot;</span><br><span class="line">tar -xf &quot;$tarball&quot; -C &quot;$tempdir&quot;</span><br><span class="line"></span><br><span class="line"># Step 4. Check if the extraction worked, if not abort</span><br><span class="line">if [ $? -ne 0 ]</span><br><span class="line">then</span><br><span class="line">    abort</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"># Step 5. Remove the old bundle directory</span><br><span class="line">echo &quot;Removing bundle...&quot;</span><br><span class="line">rm -rf &quot;$destination&quot;/*</span><br><span class="line">echo &quot;Moving new content into place...&quot;</span><br><span class="line">mv -f $tempdir&apos;/&apos;$(ls $tempdir | head -n 1)&apos;/&apos;* &quot;$destination&quot;&apos;/&apos;</span><br><span class="line">echo &quot;Make sure destination is not quarantined...&quot;</span><br><span class="line">xattr -d com.apple.quarantine &quot;$destination&quot;</span><br><span class="line">echo &quot;Removing temporary directory...&quot;</span><br><span class="line">rm -rf $tempdir</span><br><span class="line">echo &quot;Removing tarball...&quot;</span><br><span class="line">rm -rf &quot;$tarball&quot;</span><br><span class="line"></span><br><span class="line"># Step 6. (Re)launch the destination bundle</span><br><span class="line">echo &quot;Relaunching bundle...&quot;</span><br><span class="line">open &quot;$destination&quot;</span><br><span class="line"></span><br><span class="line">echo &quot;Done.&quot;</span><br><span class="line">rm -f ~/.auto-update.lock</span><br></pre></td></tr></table></figure>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><a href="https://github.com/Automattic/auto-update" target="_blank" rel="external">https://github.com/Automattic/auto-update</a></li>
<li><a href="https://github.com/Automattic/auto-update-server" target="_blank" rel="external">https://github.com/Automattic/auto-update-server</a></li>
</ul>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cocoa/">Cocoa</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2016-02-29-Cocoa Launch at Login" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/29/2016-02-29-Cocoa Launch at Login/">Cocoa Launch at Login</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/02/29/2016-02-29-Cocoa Launch at Login/" class="article-date">
  <time datetime="2016-02-29T00:00:00.000Z" itemprop="datePublished">2016-02-29</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/OS-X/">OS X</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Cocoa-Launch-at-Login"><a href="#Cocoa-Launch-at-Login" class="headerlink" title="Cocoa Launch at Login"></a>Cocoa Launch at Login</h1><p>从<a href="https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLoginItems.html" target="_blank" rel="external">Mac Developer Library</a>中查看文档：</p>
<p>有两种方式可以添加登录启动项：使用Service Management framework 或 使用 shared file list</p>
<p>这两种方式有差别：</p>
<ul>
<li><p>使用Service Management framework 在系统的登录项中是不可见的。只有卸载App才能移除登录项</p>
</li>
<li><p>使用 shared file list 在系统的登录项中是可见的。用户可以直接在面板上控制他们。（If you use this API, your login item can be disabled by the user, so any other application that communicates with it it should have reasonable fallback behavior in case the login item is disabled.） 原文还有一句大意是指这个API有隐患，所以在OS X 10.10系统上 API被大量Deprecated</p>
</li>
</ul>
<p>下面具体介绍一下 这两种的实现</p>
<h2 id="Adding-Login-Item-Using-the-Service-Management-Framework"><a href="#Adding-Login-Item-Using-the-Service-Management-Framework" class="headerlink" title="Adding Login Item Using the Service Management Framework"></a>Adding Login Item Using the Service Management Framework</h2><p>应用要包含一个 Helper Target，类型也是应用。设置路径为Contents/Library/LoginItems。设置这个Helper Target info.plist LSBackgroundOnly 为 YES。</p>
<p>使用 <code>SMLoginItemSetEnabled</code>方法授权Helper，需要传入两个参数：<code>CFStringRef</code>指的是Helper Target的bundle identifier. <code>Boolean</code> 表示期望状态。 传入 <code>true</code> Helper 会每次在用户登录的时候启动。 传入<code>false</code> 来注销这个登录项，不会在用户登录的时候启动。 这个方法会返回一个bool值，如果是ture的话，说明期望状态设置成功。如果是false的话，可能存在多个helper</p>
<p>比如 一个公司发布过很多App，但其中的helper bundle identifier都是相同的。 这样会导致在同一个电脑上只有一个App(greatest bundle version number)能成功注册登录项。</p>
<p>这个方式，我未实践过。贴几个相关的博文吧：</p>
<p><a href="http://blog.timschroeder.net/2012/07/03/the-launch-at-login-sandbox-project/" target="_blank" rel="external">The Launch At Login Sandbox Project</a></p>
<p><a href="http://rhult.github.io/articles/sandboxed-launch-on-login/" target="_blank" rel="external">Adding a preference to launch sandboxed app on login</a></p>
<p><a href="http://www.tanhao.me/pieces/590.html/" target="_blank" rel="external">在SandBox沙盒下实现程序的开机启动</a></p>
<h2 id="Adding-Login-Items-Using-a-Shared-File-List"><a href="#Adding-Login-Items-Using-a-Shared-File-List" class="headerlink" title="Adding Login Items Using a Shared File List"></a>Adding Login Items Using a Shared File List</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)isLaunchAtStartup &#123;</span><br><span class="line">    // See if the app is currently in LoginItems.</span><br><span class="line">    LSSharedFileListItemRef itemRef = [self itemRefInLoginItems];</span><br><span class="line">    // Store away that boolean.</span><br><span class="line">    BOOL isInList = itemRef != nil;</span><br><span class="line">    // Release the reference if it exists.</span><br><span class="line">    if (itemRef != nil) CFRelease(itemRef);</span><br><span class="line">    </span><br><span class="line">    return isInList;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (IBAction)toggleLaunchAtStartup:(id)sender &#123;</span><br><span class="line">    // Toggle the state.</span><br><span class="line">    BOOL shouldBeToggled = ![self isLaunchAtStartup];</span><br><span class="line">    // Get the LoginItems list.</span><br><span class="line">    LSSharedFileListRef loginItemsRef = LSSharedFileListCreate(NULL, kLSSharedFileListSessionLoginItems, NULL);</span><br><span class="line">    if (loginItemsRef == nil) return;</span><br><span class="line">    if (shouldBeToggled) &#123;</span><br><span class="line">        // Add the app to the LoginItems list.</span><br><span class="line">        CFURLRef appUrl = (__bridge CFURLRef)[NSURL fileURLWithPath:[[NSBundle mainBundle] bundlePath]];</span><br><span class="line">        LSSharedFileListItemRef itemRef = LSSharedFileListInsertItemURL(loginItemsRef, kLSSharedFileListItemLast, NULL, NULL, appUrl, NULL, NULL);</span><br><span class="line">        if (itemRef) CFRelease(itemRef);</span><br><span class="line">        [[self.statusMenu itemAtIndex:0] setTitle:@&quot;取消开机自启动&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        // Remove the app from the LoginItems list.</span><br><span class="line">        LSSharedFileListItemRef itemRef = [self itemRefInLoginItems];</span><br><span class="line">        LSSharedFileListItemRemove(loginItemsRef,itemRef);</span><br><span class="line">        if (itemRef != nil) CFRelease(itemRef);</span><br><span class="line">        [[self.statusMenu itemAtIndex:0] setTitle:@&quot;设置开机自启动&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">    CFRelease(loginItemsRef);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (LSSharedFileListItemRef)itemRefInLoginItems &#123;</span><br><span class="line">    LSSharedFileListItemRef res = nil;</span><br><span class="line">    </span><br><span class="line">    // Get the app&apos;s URL.</span><br><span class="line">    NSURL *bundleURL = [NSURL fileURLWithPath:[[NSBundle mainBundle] bundlePath]];</span><br><span class="line">    // Get the LoginItems list.</span><br><span class="line">    LSSharedFileListRef loginItemsRef = LSSharedFileListCreate(NULL, kLSSharedFileListSessionLoginItems, NULL);</span><br><span class="line">    if (loginItemsRef == nil) return nil;</span><br><span class="line">    // Iterate over the LoginItems.</span><br><span class="line">    NSArray *loginItems = (__bridge NSArray *)LSSharedFileListCopySnapshot(loginItemsRef, nil);</span><br><span class="line">    for (id item in loginItems) &#123;</span><br><span class="line">        LSSharedFileListItemRef itemRef = (__bridge LSSharedFileListItemRef)(item);</span><br><span class="line">        CFURLRef itemURLRef;</span><br><span class="line">        if (LSSharedFileListItemResolve(itemRef, 0, &amp;itemURLRef, NULL) == noErr) &#123;</span><br><span class="line">            // Again, use toll-free bridging.</span><br><span class="line">            NSURL *itemURL = (__bridge NSURL *)itemURLRef;</span><br><span class="line">            if ([itemURL isEqual:bundleURL]) &#123;</span><br><span class="line">                res = itemRef;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // Retain the LoginItem reference.</span><br><span class="line">    if (res != nil) CFRetain(res);</span><br><span class="line">    CFRelease(loginItemsRef);</span><br><span class="line">    CFRelease((__bridge CFTypeRef)(loginItems));</span><br><span class="line">    </span><br><span class="line">    return res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="http://bdunagan.com/2010/09/25/cocoa-tip-enabling-launch-on-startup/" target="_blank" rel="external">launch on startup</a></p>
<p><strong> 主要特别注意的是以上方法大都是 Deprecated in OS X V10.10 所以如果你要开发Deployment Target 10.10 以上的App的话不推荐使用这个方法。显然这些API在之后的OS X更新版本中，将会无法调用。导致你的App出现编译问题。 </strong></p>
<p>当然介于这个方式比较简单，你仍然想使用的话。你可以设置Deployment Target为 10.9 来使用这些在 10.10被废弃的API。是没有问题的。我就是这么干的，😊</p>
<h2 id="Deprecated-APIs"><a href="#Deprecated-APIs" class="headerlink" title="Deprecated APIs"></a>Deprecated APIs</h2><p>In previous versions of OS X, it is possible to add login items by sending an Apple event, by using the CFPreferences API, and by manually editing a property list file. These approaches are deprecated.</p>
<p>If you need to maintain compatibility with versions of OS X prior to v10.5, the preferred approach is to use Apple events; for details, see LoginItemsAE. Using the CFPreferences API is an acceptable alternative. You should not directly edit the property list file on any version of OS X.</p>
<p>早些 OS X版本的API 和实现方式，现在也许行不通了。我就不翻译了。 </p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cocoa/">Cocoa</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
      </nav>
    </section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 miaoyou.gmy&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
</html>