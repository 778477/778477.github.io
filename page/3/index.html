<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>778477</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="778477">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="778477">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="778477">
<meta name="twitter:description">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo logo-text" href="/">778477</a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer">
      <article id="post-2016-02-02-Range Sum Query - Mutable" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/02/2016-02-02-Range Sum Query - Mutable/">Range Sum Query Mutable</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/02/02/2016-02-02-Range Sum Query - Mutable/" class="article-date">
  <time datetime="2016-02-02T00:00:00.000Z" itemprop="datePublished">2016-02-02</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a><span>></span><a class="article-category-link" href="/categories/Algorithm/LeetCode/">LeetCode</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://leetcode.com/problems/range-sum-query-mutable/" target="_blank" rel="external">Range Sum Query - Mutable</a></p>
<p>给定一个整形数组。会有两个操作</p>
<p>操作1：查询区间(i,j)的总和</p>
<p>操作2：更新元素(i,val) 下标为i的元素 值更新为val</p>
<p>提示：</p>
<ul>
<li>数组元素的修改只有通过 update 方法</li>
<li>update 和 sumRange 方法调用是不确定次数和顺序的（distributed evenly 分布式）</li>
</ul>
<p>这个是一个经典的问题。类似 RMQ(Range Minimum/Maximum Query)，区间最值查询。不过我们注意到有操作2，就表示说数据是可变的，离线算法就不考虑了。</p>
<p>这类题目有一个现成的数据结构可以解决：<a href="https://en.wikipedia.org/wiki/Segment_tree" target="_blank" rel="external">SegmentTree 线段树</a></p>
<p>由于线段树是平衡二叉树，所以深度是logn。就是算查询的区间和的时间复杂度是 O(logn)的。</p>
<p><img src="http://d1gjlxt8vb0knt.cloudfront.net//wp-content/uploads/segment-tree1.png" alt="segment-tree1"></p>
<p>由上图可知，叶子节点均为数组元素。我们在做ACM题的常常会提到一个线段树常数，其实是指线段树的空间复杂度。按照数组n来推算线段树的空间复杂度。</p>
<p>时间复杂度大体分为： </p>
<ul>
<li>初始化 建树O(n) </li>
<li>区间查询和 O(logn) </li>
<li>更新单值O(logn) </li>
</ul>
<p>时间复杂度理想是线性的，不因为n的变化产生剧烈抖动。空间复杂度是O(nlogn)</p>
<blockquote>
<p>A segment tree T on a set I of n intervals uses O(nlogn) storage.</p>
<p>Proof:<br>Lemma: Any interval [x, x′] of I is stored in the canonical set for at most two nodes at the    same depth.</p>
<p>Proof: Let v1, v2, v3 be the three nodes at the same depth, numbered from left to right; and let p(v) be the parent node of any given node v. Suppose [x, x′] is stored at v1 and v3. This means that [x, x′] spans the whole interval from the left endpoint of Int(v1) to the right endpoint of Int(v3). Note that all segments at a particular level are non-overlapping and ordered from left to right: this is true by construction for the level containing the leaves, and the property is not lost when moving from any level to the one above it by combining pairs of adjacent segments. Now either p(v2) = p(v1), or the former is to the right of the latter (edges in the tree do not cross). In the first case, Int(p(v2))’s leftmost point is the same as Int(v1)’s leftmost point; in the second case, Int(p(v2))’s leftmost point is to the right of Int(p(v1))’s rightmost point, and therefore also to the right of Int(v1)’s rightmost point. In both cases, Int(p(v2)) begins at or to the right of Int(v1)’s leftmost point. Similar reasoning shows that Int(p(v2)) ends at or to the left of Int(v3)’s rightmost point. Int(p(v2)) must therefore be contained in [x, x′]; hence, [x, x′] will not be stored at v2.<br>The set I has at most 4n + 1 elementary intervals. Because T is a binary balanced tree with at most 4n + 1 leaves, its height is O(logn). Since any interval is stored at most twice at a given depth of the tree, that the total amount of storage is O(nlogn).</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">typedef unsigned long lusigned;</span><br><span class="line"></span><br><span class="line">struct SegmenTreeNode&#123;</span><br><span class="line">    int val;</span><br><span class="line">    lusigned star,end;</span><br><span class="line">    SegmenTreeNode *left,*right;</span><br><span class="line">    SegmenTreeNode(lusigned _star,lusigned _end,int _val)&#123;</span><br><span class="line">        val = _val;</span><br><span class="line">        star = _star, end = _end;</span><br><span class="line">        left = right = NULL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">class NumArray &#123;</span><br><span class="line">public:</span><br><span class="line">    NumArray(vector&lt;int&gt; &amp;nums) &#123;</span><br><span class="line">        numbers = nums;</span><br><span class="line">        if(nums.size() &gt;= 1)&#123;</span><br><span class="line">            rootNode = buildSegmentTree(0, 0, nums.size()-1, nums);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    void update(int i, int val)&#123;</span><br><span class="line">        updateNodeVal(rootNode, i, val);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    int sumRange(int i, int j) &#123;</span><br><span class="line">        if(j &lt; i) return 0;</span><br><span class="line">        return querySumValInSegmentTree(rootNode, 0, numbers.size()-1, i, j);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">private:</span><br><span class="line">    vector&lt;int&gt; numbers;</span><br><span class="line">    SegmenTreeNode *rootNode;</span><br><span class="line">    SegmenTreeNode *buildSegmentTree(int root,lusigned star,lusigned end,const vector&lt;int&gt; nums)&#123;</span><br><span class="line">        </span><br><span class="line">        SegmenTreeNode *rootNode = new SegmenTreeNode(star, end, 0);</span><br><span class="line">        </span><br><span class="line">        if(star == end)&#123;</span><br><span class="line">            rootNode-&gt;val = nums[star];</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            lusigned mid = (star + end)/2;</span><br><span class="line">            rootNode-&gt;left = buildSegmentTree(root*2+1, star, mid, nums);</span><br><span class="line">            rootNode-&gt;right =  buildSegmentTree(root*2+2, mid+1, end, nums);</span><br><span class="line">            </span><br><span class="line">            rootNode-&gt;val = rootNode-&gt;left-&gt;val + rootNode-&gt;right-&gt;val;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        return rootNode;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    int updateNodeVal(SegmenTreeNode *root, int idx,int value)&#123;</span><br><span class="line">        if(root-&gt;star == root-&gt;end &amp;&amp; root-&gt;star == idx)  return (root-&gt;val = value);</span><br><span class="line">        else if(root-&gt;star == root-&gt;end) return root-&gt;val;</span><br><span class="line">        </span><br><span class="line">        lusigned mid = (root-&gt;star + root-&gt;end)&gt;&gt;1;</span><br><span class="line">        if(idx &lt;= mid)&#123;</span><br><span class="line">            root-&gt;left-&gt;val = updateNodeVal(root-&gt;left, idx, value);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            root-&gt;right-&gt;val = updateNodeVal(root-&gt;right, idx, value);</span><br><span class="line">        &#125;</span><br><span class="line">        return (root-&gt;val = root-&gt;left-&gt;val + root-&gt;right-&gt;val);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    int querySumValInSegmentTree(SegmenTreeNode *root, lusigned star,lusigned end,lusigned qSidx,lusigned qEidx)&#123;</span><br><span class="line">        </span><br><span class="line">        if(qSidx &lt;= star &amp;&amp; qEidx &gt;= end) return root-&gt;val;</span><br><span class="line">        </span><br><span class="line">        if(qEidx &lt; star || qSidx &gt; end) return 0;</span><br><span class="line">        </span><br><span class="line">        lusigned mid = (star + end) / 2;</span><br><span class="line">        </span><br><span class="line">        int leftSumVal = querySumValInSegmentTree(root-&gt;left, star, mid, qSidx, qEidx);</span><br><span class="line">        int rightSumVal = querySumValInSegmentTree(root-&gt;right, mid+1, end, qSidx, qEidx);</span><br><span class="line">        </span><br><span class="line">        return leftSumVal + rightSumVal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/Range%20Sum%20Query%20Accepted.png" alt="accepted"></p>
<p>不太明白为什么 leetCode Judge 中 C/C++ 的效率最低，Java最高。这个明显是不合理的。。</p>
<p>最后 关于 线段树的更新是有优化空间的。看一看这组操作</p>
<ol>
<li>操作1</li>
<li>操作2 </li>
<li>操作2</li>
<li>操作2</li>
<li>操作2</li>
<li>操作2</li>
<li>操作2</li>
</ol>
<p>其实 后面的操作2 如果没有接着操作1的话，其实我们没有必要实时更新单点值。这里就有一个延迟更新的优化点，也是线段树的精髓。 我之后有空补充:)</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LeetCode/">LeetCode</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2015-12-16-Lighter View Controller" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/2015-12-16-Lighter View Controller/">Lighter View Controller</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/12/16/2015-12-16-Lighter View Controller/" class="article-date">
  <time datetime="2015-12-16T00:00:00.000Z" itemprop="datePublished">2015-12-16</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://www.objc.io/issues/1-view-controllers/lighter-view-controllers/" target="_blank" rel="external">Lighter-View-Controller 轻量级视图控制器</a></p>
<p>视图控制器们(View Controllers)通常是最大的文件在我们的iOS工程中。而且 他们常常有很多不必要的代码。导致视图控制器往往是无法在其他项目中复用的。我们下面讲述的技巧可以让控制器们 更加轻量，有复用性，让不合理的代码出现在合理的位置</p>
<p><a href="https://github.com/objcio/issue-1-lighter-view-controllers" target="_blank" rel="external">example project on GitHub</a></p>
<h3 id="分离出数据协议和其他接口协议"><a href="#分离出数据协议和其他接口协议" class="headerlink" title="分离出数据协议和其他接口协议"></a>分离出数据协议和其他接口协议</h3><ul>
<li>一个很有用的技巧就是将视图控制器中的 <code>UITableViewDataSource</code> 这部分代码分离出来。独立写一个类来维护，如果你都是这么处理的话，那么你这些类是可以以后在其他项目中复用的。</li>
<li>这样做还有一个好处就是，我们可以独立测试这个类。</li>
</ul>
<p>举个例子：在示例项目中，<code>PhotosViewController</code> 有这样几个方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># pragma mark Pragma </span><br><span class="line"></span><br><span class="line">- (Photo*)photoAtIndexPath:(NSIndexPath*)indexPath &#123;</span><br><span class="line">    return photos[(NSUInteger)indexPath.row];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSInteger)tableView:(UITableView*)tableView </span><br><span class="line"> numberOfRowsInSection:(NSInteger)section &#123;</span><br><span class="line">    return photos.count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (UITableViewCell*)tableView:(UITableView*)tableView </span><br><span class="line">        cellForRowAtIndexPath:(NSIndexPath*)indexPath &#123;</span><br><span class="line">    PhotoCell* cell = [tableView dequeueReusableCellWithIdentifier:PhotoCellIdentifier </span><br><span class="line">                                                      forIndexPath:indexPath];</span><br><span class="line">    Photo* photo = [self photoAtIndexPath:indexPath];</span><br><span class="line">    cell.label.text = photo.name;</span><br><span class="line">    return cell;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>让我们试着把这些代码放到 我们自己的类上。我们用闭包来填充数据(或许协议更合适，这个取决于你)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@implementation ArrayDataSource</span><br><span class="line"></span><br><span class="line">- (id)itemAtIndexPath:(NSIndexPath*)indexPath &#123;</span><br><span class="line">    return items[(NSUInteger)indexPath.row];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSInteger)tableView:(UITableView*)tableView </span><br><span class="line"> numberOfRowsInSection:(NSInteger)section &#123;</span><br><span class="line">    return items.count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (UITableViewCell*)tableView:(UITableView*)tableView </span><br><span class="line">        cellForRowAtIndexPath:(NSIndexPath*)indexPath &#123;</span><br><span class="line">    id cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier</span><br><span class="line">                                              forIndexPath:indexPath];</span><br><span class="line">    id item = [self itemAtIndexPath:indexPath];</span><br><span class="line">    configureCellBlock(cell,item);</span><br><span class="line">    return cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>这三个方法不再存在我们的视图控制器了，我们可以创建实例来承接table view的数据协议委托</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">void (^configureCell)(PhotoCell*, Photo*) = ^(PhotoCell* cell, Photo* photo) &#123;</span><br><span class="line">   cell.label.text = photo.name;</span><br><span class="line">&#125;;</span><br><span class="line">photosArrayDataSource = [[ArrayDataSource alloc] initWithItems:photos</span><br><span class="line">                                                cellIdentifier:PhotoCellIdentifier</span><br><span class="line">                                            configureCellBlock:configureCell];</span><br><span class="line">self.tableView.dataSource = photosArrayDataSource;</span><br></pre></td></tr></table></figure>
<p>而且，这种办法扩展其他接口协议也很方便。比如 另外的一个list数据协议是 <code>UICollectionViewDataSource</code> 由于一些需求实现，你们决定将 <code>UITableView</code> 替换为 <code>UICollectionView</code>。实际上你的视图控制器不需要任何改动，你可以让你的类都支持这两个数据协议。</p>
<h3 id="逻辑处理放在Model"><a href="#逻辑处理放在Model" class="headerlink" title="逻辑处理放在Model"></a>逻辑处理放在Model</h3><p> 这里还是一个例子，这些代码在view controller里，功能是返回一个列表，上面的数据是用户的活跃度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (void)loadPriorities &#123;</span><br><span class="line">  NSDate* now = [NSDate date];</span><br><span class="line">  NSString* formatString = @&quot;startDate &lt;= %@ AND endDate &gt;= %@&quot;;</span><br><span class="line">  NSPredicate* predicate = [NSPredicate predicateWithFormat:formatString, now, now];</span><br><span class="line">  NSSet* priorities = [self.user.priorities filteredSetUsingPredicate:predicate];</span><br><span class="line">  self.priorities = [priorities allObjects];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当这些代码被放置到 User类的扩展中时，view controller就看起来比较清爽了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (void)loadPriorities &#123;</span><br><span class="line">  self.priorities = [self.user currentPriorities];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>User+Extensions.m:</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (NSArray*)currentPriorities &#123;</span><br><span class="line">  NSDate* now = [NSDate date];</span><br><span class="line">  NSString* formatString = @&quot;startDate &lt;= %@ AND endDate &gt;= %@&quot;;</span><br><span class="line">  NSPredicate* predicate = [NSPredicate predicateWithFormat:formatString, now, now];</span><br><span class="line">  return [[self.priorities filteredSetUsingPredicate:predicate] allObjects];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然在实际项目中，有些代码不是那么轻松可以转移到Model当中的。所以我们要创建 “数据仓库”(Store Class)</p>
<h3 id="创建仓库类"><a href="#创建仓库类" class="headerlink" title="创建仓库类"></a>创建仓库类</h3><p>我们有些代码是从文件中加载数据并处理数据的，这些代码大概是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (void)readArchive &#123;</span><br><span class="line">    NSBundle* bundle = [NSBundle bundleForClass:[self class]];</span><br><span class="line">    NSURL *archiveURL = [bundle URLForResource:@&quot;photodata&quot;</span><br><span class="line">                                 withExtension:@&quot;bin&quot;];</span><br><span class="line">    NSAssert(archiveURL != nil, @&quot;Unable to find archive in bundle.&quot;);</span><br><span class="line">    NSData *data = [NSData dataWithContentsOfURL:archiveURL</span><br><span class="line">                                         options:0</span><br><span class="line">                                           error:NULL];</span><br><span class="line">    NSKeyedUnarchiver *unarchiver = [[NSKeyedUnarchiver alloc] initForReadingWithData:data];</span><br><span class="line">    _users = [unarchiver decodeObjectOfClass:[NSArray class] forKey:@&quot;users&quot;];</span><br><span class="line">    _photos = [unarchiver decodeObjectOfClass:[NSArray class] forKey:@&quot;photos&quot;];</span><br><span class="line">    [unarchiver finishDecoding];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其实 View Controller 没有必要关心数据是如何处理的，我们创建 数据仓库来处理这些。使这些代码分离出来，这样我们就可以复用这个仓库类了。<br>独立测试并且View Controller的代码量又减少了一些。这些数据仓库负责数据处理，持久化和数据库交互。我们也可以叫这些”仓库”为服务层或资料库</p>
<h3 id="将网络服务逻辑转移到Model"><a href="#将网络服务逻辑转移到Model" class="headerlink" title="将网络服务逻辑转移到Model"></a>将网络服务逻辑转移到Model</h3><p>这是一个类似的优化逻辑：不要把网络交互放在View Controller。把这些逻辑独立放置在其他类中，可以调用方法并设置回调处理。<br>这样做的好处是你可以格外处理所有你的数据和错误在这个类上。而不会让View Controller变的臃肿</p>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>我们看到有很多技巧可以让View Controller更加精简。我们努力让这些技巧在实际开发中更加实用。<br>我们只有一个目的：写出可维护的代码。知道这些模式之后，我们有更加深刻的认识来讨论如何将笨重的View Controller精简优化。</p>
<h3 id="扩展阅读"><a href="#扩展阅读" class="headerlink" title="扩展阅读"></a>扩展阅读</h3><ul>
<li><a href="https://developer.apple.com/library/mac/documentation/General/Conceptual/DevPedia-CocoaCore/ControllerObject.html" target="_blank" rel="external">Cocoa Core Competencies: Controller Object</a></li>
<li><a href="http://subjective-objective-c.blogspot.de/2011/08/writing-high-quality-view-controller.html" target="_blank" rel="external">Writing high quality view controllers</a></li>
<li><a href="https://programmers.stackexchange.com/questions/184396/mvcs-model-view-controller-store" target="_blank" rel="external">Programmers Stack Exchange: Model View Controller Store</a></li>
<li><a href="https://programmers.stackexchange.com/questions/177668/how-to-avoid-big-and-clumsy-uitableviewcontroller-on-ios" target="_blank" rel="external">Programmers Stack Exchange: How to avoid big and clumsy UITableViewControllers on iOS
</a></li>
</ul>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2015-11-27-Minimum Window Substring" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/27/2015-11-27-Minimum Window Substring/">Minimum Window Substring</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/11/27/2015-11-27-Minimum Window Substring/" class="article-date">
  <time datetime="2015-11-27T00:00:00.000Z" itemprop="datePublished">2015-11-27</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a><span>></span><a class="article-category-link" href="/categories/Algorithm/LeetCode/">LeetCode</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://leetcode.com/problems/minimum-window-substring/" target="_blank" rel="external">Minimum Window Substring</a></p>
<p>题目大意：<br>给定一个字符串S 和 另一个字符串T，在S中找到一个最短长度的子串包含T中所有的字母。 时间期望是O(N)<br>如：<br><code>S = &quot;ADOBECODEBANC&quot;</code><br><code>T = &quot;ABC&quot;</code><br>最短子串是 <code>&quot;BANC&quot;</code></p>
<p>提示：</p>
<ul>
<li>如果没有找到子串，则返回<code>&quot;&quot;</code>空串</li>
<li>如果有多个满足条件的字串，题目保证最短子串只有唯一的一个</li>
</ul>
<p>思路：<br>维护一个计数数组CountTable统计字符串T所出现的所有字母次数，再开始遍历字符串S，同时开始统计T所出现的字母在S所出现的次数。 如果遍历过程中统计的字母次数和T的长度相同，说明我们遍历的得到的这个子串就是一个 Window Substring，满足条件！记录这个subString，开始缩小这个Window Substring，直到条件不满足 继续遍历寻找下一个 Window Substring。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">public:</span><br><span class="line">    string minWindow(string s, string t) &#123;</span><br><span class="line">        string ans = "";</span><br><span class="line">        if(t.length() &gt; s.length()) return ans;</span><br><span class="line">        </span><br><span class="line">        vector&lt;int&gt; countTable(256,0);</span><br><span class="line">        </span><br><span class="line">        for_each(t.begin(), t.end(), [&amp;](const char ch)&#123;</span><br><span class="line">            countTable[ch]++;</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        vector&lt;int&gt; foundTable(256,0);</span><br><span class="line">        queue&lt;unsigned long&gt; Q;</span><br><span class="line">        unsigned long maxLen(s.length()),count(0);</span><br><span class="line">        for(size_t i = 0;i&lt;s.length();i++)&#123;</span><br><span class="line">            if(countTable[s[i]] &gt; 0)&#123;</span><br><span class="line">                foundTable[s[i]] ++;</span><br><span class="line">                Q.push(i);</span><br><span class="line">                if(foundTable[s[i]] &lt;= countTable[s[i]]) count++;</span><br><span class="line">                if(count == t.length())&#123;</span><br><span class="line">                    unsigned long idx;</span><br><span class="line">                    do &#123;</span><br><span class="line">                        idx = Q.front();</span><br><span class="line">                        Q.pop();</span><br><span class="line">                        foundTable[s[idx]]--;</span><br><span class="line">                    &#125; while (foundTable[s[idx]] &gt;= countTable[s[idx]]);</span><br><span class="line">                    if(i-idx &lt; maxLen) ans = s.substr(idx,i-idx+1),maxLen = ans.length();</span><br><span class="line">                    count --;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/Minimum%20Window%20Substring.png" alt="Accepted"></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LeetCode/">LeetCode</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2015-11-24-为iOS建立 Travis CI" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/24/2015-11-24-为iOS建立 Travis CI/">为iOS建立 Travis CI</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/11/24/2015-11-24-为iOS建立 Travis CI/" class="article-date">
  <time datetime="2015-11-24T00:00:00.000Z" itemprop="datePublished">2015-11-24</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a><span>></span><a class="article-category-link" href="/categories/iOS/持续集成/">持续集成</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://objccn.io/issue-6-5/" target="_blank" rel="external">为iOS建立 Travis CI</a></p>
<p>我给自己的GMYHotSpotView项目 关联了这个 持续集成的工具 .travis.yml文件编写如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">language: objective-c</span><br><span class="line">script: xcodebuild -workspace GMYHotSpotView.xcworkspace -scheme GMYHotSpotView</span><br></pre></td></tr></table></figure>
<p><a href="https://docs.travis-ci.com/user/languages/objective-c/" target="_blank" rel="external">Building an Objective-C Project</a></p>
<p>我后面遇到的一个比较麻烦的问题是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Check dependencies</span><br><span class="line">Code Sign error: No code signing identities found: No valid signing identities.</span><br></pre></td></tr></table></figure>
<p>最后修改.travis.yml文件，主要是新增了 <strong> CODE_SIGN_IDENTITY=”” CODE_SIGNING_REQUIRED=NO </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## http://lint.travis-ci.org/</span><br><span class="line">language: objective-c</span><br><span class="line">xcode_workspace: GMYHotSpotView.xcworkspace</span><br><span class="line">xcode_scheme: GMYHotSpotView</span><br><span class="line">script: xcodebuild -workspace GMYHotSpotView.xcworkspace -scheme GMYHotSpotView CODE_SIGN_IDENTITY=&quot;&quot; CODE_SIGNING_REQUIRED=NO</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/travis-ci1.png" alt="CI"></p>
<p>指示灯是可以拿来使用的  <a href="https://travis-ci.org/778477/GMYHotSpotView" target="_blank" rel="external"><img src="https://travis-ci.org/778477/GMYHotSpotView.svg?branch=master" alt="Build Status"></a></p>
<p><del>GitHub上还有一个很完善的YAML配置 <a href="https://github.com/BoltsFramework/Bolts-iOS/blob/master/.travis.yml" target="_blank" rel="external">https://github.com/BoltsFramework/Bolts-iOS/blob/master/.travis.yml</a></del> <strong>这个没啥卵用</strong></p>
<blockquote>
<p><a href="http://www.infoq.com/cn/articles/build-ios-continuous-integration-platform-part3" target="_blank" rel="external">构建iOS持续集成平台（三）——CI服务器与自动化部署 @infoQ</a></p>
<p><a href="http://stackoverflow.com/questions/27671854/travis-ci-fails-to-build-with-a-code-signing-error" target="_blank" rel="external">http://stackoverflow.com/questions/27671854/travis-ci-fails-to-build-with-a-code-signing-error</a></p>
<p><a href="http://stackoverflow.com/questions/27671854/travis-ci-fails-to-build-with-a-code-signing-error" target="_blank" rel="external">http://stackoverflow.com/questions/27671854/travis-ci-fails-to-build-with-a-code-signing-error</a></p>
</blockquote>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2015-10-23-Valid-Number" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/23/2015-10-23-Valid-Number/">Vaild Number</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/10/23/2015-10-23-Valid-Number/" class="article-date">
  <time datetime="2015-10-23T00:00:00.000Z" itemprop="datePublished">2015-10-23</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a><span>></span><a class="article-category-link" href="/categories/Algorithm/LeetCode/">LeetCode</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://leetcode.com/submissions/detail/43806015/" target="_blank" rel="external">Vaild Number</a></p>
<p>判断给定的一个字符串是否是数字。</p>
<p>Note: 题目对于数字的合法定义没有给出具体限定，你应该根据判断返回结果来调整自己的程序。 (这个超坑的，我差不多错误提交了8次。有些后台TestCase的合理性是有待讨论的<a href="https://leetcode.com/discuss/3303/the-worst-problem-i-have-ever-met-in-this-oj" target="_blank" rel="external">吐槽传送门</a>)</p>
<p>言归正传。这类题目，我们一般称为 模拟题。是因为该题目没有对应具体算法和数据结构，我们只能按照题目描述的分支情况，模拟实现。其实，这个题目我在杭电OJ上做过了。。。</p>
<p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1409" target="_blank" rel="external">Is It a Number</a></p>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/hud-1409-accepted.png" alt="accetped"></p>
<p>当时我就是当模拟题做的，现在看来这种解法不太优雅。 看了一下 Discuss，发现大多数人使用 DFA(有限状态自动机)。城！会！玩！</p>
<p>按照这个思路，我们来动手实践一下。 首先是状态的划分，因为 鉴别是否是数字，字符集{‘0’-‘9’,’+’,’-‘,’.’,’E’}。根据数字的定义，状态是有限的。 所以我们大体划分出这么集中状态：</p>
<pre><code>1. UnkownState 起始状态，没有任何字符输入。能接受的下一步字符为 数字|正负号|小数点
2. NumberState 输入数字状态，能接受的下一步字符为 数字|小数点|科学计数法(E,e)
3. OnlyNumberState 数字接着输入小数点状态，能接受下一步字符为 数字|科学计数法(E,e)
4. OperatorState 输入运算法状态，能接受下一步字符为 数字|小数点
5. DecimalPointState 输入小数点状态，能接受下一步字符为 数字
6. ScientificState 输入科学计数法状态，能接受下一步字符为 数字|正负号
7. NoscientificState 科学计数法接着输入正负号状态，能接受下一步字符为 数字
8. IllegalState 非法输入状态 
9. EndState 终态 能接受下一步字符 为数字
</code></pre><p>这里的状态命名比较随意。 状态之间的转移是关键。最后，我们认为 2，3，9状态为合法状态。停留在其他状态的输入情况，不能认为是数字。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> State&#123;</span><br><span class="line">    UnkownState  = <span class="number">0</span>,       </span><br><span class="line">    NumberState = <span class="number">1</span>,         </span><br><span class="line">    OnlyNumberState = <span class="number">2</span>,	 </span><br><span class="line">    OperatorState = <span class="number">3</span>,      </span><br><span class="line">    DecimalPointState = <span class="number">4</span>,  </span><br><span class="line">    ScientificState = <span class="number">5</span>,    </span><br><span class="line">    NoscientificState = <span class="number">6</span>, </span><br><span class="line">    IllegalState = <span class="number">7</span>,</span><br><span class="line">    EndState,</span><br><span class="line">&#125;State;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isNumber</span><span class="params">(<span class="keyword">char</span>* s)</span> </span>&#123;</span><br><span class="line">    State state = UnkownState;</span><br><span class="line">    <span class="keyword">while</span> (*s == <span class="string">' '</span>)  s++;</span><br><span class="line">    <span class="keyword">char</span> *p = (s+<span class="built_in">strlen</span>(s)<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">while</span> (*p == <span class="string">' '</span>)  --p;</span><br><span class="line">    *(p+<span class="number">1</span>) = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (*s) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (state) &#123;</span><br><span class="line">            <span class="keyword">case</span> UnkownState:&#123;</span><br><span class="line">                state = IllegalState;</span><br><span class="line">                <span class="keyword">if</span>(*s == <span class="string">'+'</span> || *s == <span class="string">'-'</span>) state = OperatorState;</span><br><span class="line">                <span class="keyword">if</span>(*s &gt;= <span class="string">'0'</span> &amp;&amp; *s &lt;= <span class="string">'9'</span>) state = NumberState;</span><br><span class="line">                <span class="keyword">if</span>(*s == <span class="string">'.'</span>) state = DecimalPointState;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> NumberState:&#123;</span><br><span class="line">                state = IllegalState;</span><br><span class="line">                <span class="keyword">if</span>(*s &gt;= <span class="string">'0'</span> &amp;&amp; *s &lt;= <span class="string">'9'</span>) state = NumberState;</span><br><span class="line">                <span class="keyword">if</span>(*s == <span class="string">'.'</span>) state = OnlyNumberState;</span><br><span class="line">                <span class="keyword">if</span>(*s == <span class="string">'e'</span> || *s == <span class="string">'E'</span>) state = ScientificState;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> OnlyNumberState:&#123;</span><br><span class="line">                state = IllegalState;</span><br><span class="line">                <span class="keyword">if</span>(*s &gt;= <span class="string">'0'</span> &amp;&amp; *s &lt;= <span class="string">'9'</span>) state = OnlyNumberState;</span><br><span class="line">                <span class="keyword">if</span>(*s == <span class="string">'e'</span> || *s == <span class="string">'E'</span>) state = ScientificState;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> OperatorState:&#123;</span><br><span class="line">                state = IllegalState;</span><br><span class="line">                <span class="keyword">if</span>(*s &gt;= <span class="string">'0'</span> &amp;&amp; *s &lt;= <span class="string">'9'</span>) state = NumberState;</span><br><span class="line">                <span class="keyword">if</span>(*s == <span class="string">'.'</span> ) state = DecimalPointState;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> DecimalPointState:&#123;</span><br><span class="line">                state = IllegalState;</span><br><span class="line">                <span class="keyword">if</span>(*s &gt;= <span class="string">'0'</span> &amp;&amp; *s &lt;= <span class="string">'9'</span>) state = OnlyNumberState;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> ScientificState:&#123;</span><br><span class="line">                state = IllegalState;</span><br><span class="line">                <span class="keyword">if</span>(*s == <span class="string">'+'</span> || *s == <span class="string">'-'</span>) state = NoscientificState;</span><br><span class="line">                <span class="keyword">if</span>(*s &gt;= <span class="string">'0'</span> &amp;&amp; *s &lt;= <span class="string">'9'</span>) state = EndState;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> NoscientificState:&#123;</span><br><span class="line">                state = IllegalState;</span><br><span class="line">                <span class="keyword">if</span>(*s &gt;= <span class="string">'0'</span> &amp;&amp; *s &lt;=<span class="string">'9'</span>) state = EndState;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> EndState:&#123;</span><br><span class="line">                state = IllegalState;</span><br><span class="line">                <span class="keyword">if</span>(*s &gt;= <span class="string">'0'</span> &amp;&amp; *s &lt;=<span class="string">'9'</span>) state = EndState;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> IllegalState:&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        s++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (state == NumberState || state == OnlyNumberState || state == EndState);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> str[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">while</span>(gets(str))&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s %s\n"</span>,str,isNumber(str) ? <span class="string">"is a Number"</span>:<span class="string">"isn't a Number"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/vaild-number-accepted.png" alt="accepeted"></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LeetCode/">LeetCode</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2015-10-20-Reveal调试模拟器" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/08/2015-10-20-Reveal调试模拟器/">Reveal 调试模拟器</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/10/08/2015-10-20-Reveal调试模拟器/" class="article-date">
  <time datetime="2015-10-08T00:00:00.000Z" itemprop="datePublished">2015-10-08</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a><span>></span><a class="article-category-link" href="/categories/iOS/工具/">工具</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="使用Reveal进行视图分析"><a href="#使用Reveal进行视图分析" class="headerlink" title="使用Reveal进行视图分析"></a>使用Reveal进行视图分析</h2><p>Reveal比Xcode自带的Debug View Hierarchy要给力一些。好吧，这句话我收回-。- Xcode7中的视图调试貌似改进了很多，还支持debug。言归正传，说一下如何使用 <strong>Reveal</strong> 吧</p>
<p>官方有三种使用方法：</p>
<ol>
<li><p><strong>Static Linking</strong></p>
<ul>
<li>Linking Reveal’s static library into your iOS application is the quickest and easiest way to enable Reveal introspection.</li>
</ul>
</li>
<li><p><strong>Dynamic Loading</strong></p>
<ul>
<li>Dynamic loading allows third party libraries to be loaded into an iOS application on demand, at runtime. In this scenario the library is not linked in to the executable, but is instead included in the app bundle and can be loaded on demand. This approach allows developers to maintain full control over when the Reveal library is loaded, and when the service is started and stopped within their application.</li>
</ul>
</li>
<li><strong>CocoaPods</strong><ul>
<li>CocoaPods is a dependency management system for iOS and OSX projects. It automates the configuration of workspaces to manage 3rd party library dependencies in Xcode projects.</li>
</ul>
</li>
</ol>
<p>我们不希望使用一个三方工具，还要修改代码。所以我们重点关注第二个Dynamic Loading。</p>
<p>下面是我直译版本：</p>
<h2 id="在不修改工程项目的情况加载-Reveal"><a href="#在不修改工程项目的情况加载-Reveal" class="headerlink" title="在不修改工程项目的情况加载 Reveal"></a>在不修改工程项目的情况加载 Reveal</h2><p><strong>这个方法只是适用于项目运行在模拟器上</strong></p>
<p>加载Reveal不需要修改工程项目是一个极好的办法。方便让你分析iOS App，不用去考虑修改工程所带来的隐患了。</p>
<ol>
<li>使用Xcode打开你的项目，选择 View(视图)-&gt;Navigators(导航)-&gt;Show Breakpoint Navigator(断点导航栏)</li>
<li>在底部栏的左边有一个加号，点击添加符号断点(Symbolic Breakpoint) <img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/add-symbolic-breakpoint-menu.jpg" alt="add-symbolic-breakpoint"></li>
<li>右键编辑断点 输入<code>UIApplicationMain</code> 到Symbol输入框中</li>
<li>点击<code>add action</code>按钮，确认action设置为<code>Debugger Command</code></li>
<li>复制下面的语句到输入框中 <code>expr (Class)NSClassFromString(@&quot;IBARevealLoader&quot;) == nil ? (void *)dlopen(&quot;/Applications/Reveal.app/Contents/SharedSupport/iOS-Libraries/libReveal.dylib&quot;, 0x2) : ((void*)0)</code><ul>
<li>需要确认你的Reveal安装路径是否一致</li>
</ul>
</li>
<li>检查<code>Automatically continue after evaluating actions.</code>选项是否勾选<img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/setup-breakpoint-popup.jpg" alt="setup-breakpoint-popup"></li>
<li>右键点击这个最新创建的断点选择<code>Move Breakpoint To</code>-&gt; <code>User</code><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/move-breakpoint-to-user.jpg" alt="move-breakpoint-to-user"></li>
<li>在Xcode编译并运行你的应用在iOS模拟器上。如果一切步骤设置ok的话，你在 Reveal 上切换选择你的App就可以愉快的开始</li>
</ol>
<blockquote>
<p><a href="http://support.revealapp.com/" target="_blank" rel="external">http://support.revealapp.com/</a></p>
</blockquote>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Reveal/">Reveal</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2015-10-08-Different-iOS-SDK-Version-Compile" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/08/2015-10-08-Different-iOS-SDK-Version-Compile/">Different iOS SDK Version Compile</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/10/08/2015-10-08-Different-iOS-SDK-Version-Compile/" class="article-date">
  <time datetime="2015-10-08T00:00:00.000Z" itemprop="datePublished">2015-10-08</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>前言</strong></p>
<hr>
<p>我们在开发feature的时候依赖 iOS9 SDK中的新framework，注意这个framework只有iOS9才有。但是我们有两套打包环境</p>
<ul>
<li>Xcode6 - iOS8</li>
<li>Xcode7 - iOS9</li>
</ul>
<p>如果不做任何处理的话，在第一套打包环境下会出现 ‘XX.h’ file not found.</p>
<p>我们希望编写的代码能够兼容这两套打包环境. </p>
<p>Google 区分iOS系统版本 得到以下结果：</p>
<p><a href="http://www.yifeiyang.net/iphone-development-techniques-of-environmental-chapter-7-distinguish-between-different-versions-of-the-iphone/" target="_blank" rel="external">iPhone开发技巧之环境篇（7）— 区分不同版本的iPhone</a></p>
<p><a href="http://justsee.iteye.com/blog/1621533" target="_blank" rel="external">区分ios设备，os版本，sdk版本</a></p>
<p>我们只关心文章最后的段落:iPhone OS SDK版本，我们希望在 iOS9下 编译我们的feature代码，在iOS9之前的系统版本不编译，不执行。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> __IPHONE_OS_VERSION_MAX_ALLOWED &gt; __IPHONE_2_2</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">if</span> __IPHONE_OS_VERSION_MAX_ALLOWED &gt; __IPHONE_3_1</span></span><br><span class="line">        <span class="comment">// iPhone OS SDK 4.0 以后版本的处理</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">        <span class="comment">// iPhone OS SDK 3.0 ~ 4.0 版本的处理</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">    <span class="comment">// iPhone OS SDK 3.0 之前版本的处理</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>但是，这还是有一个坑。 我们来看一下 具体的宏定义在 <code>AvailabilityInternal.h</code> 中。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#ifdef __IPHONE_OS_VERSION_MIN_REQUIRED</span><br><span class="line">   /* make sure a default max version is set */</span><br><span class="line">   #ifndef __IPHONE_OS_VERSION_MAX_ALLOWED</span><br><span class="line">       #define __IPHONE_OS_VERSION_MAX_ALLOWED     __IPHONE_9_0</span><br><span class="line">   #endif</span><br><span class="line">   /* make sure a valid min is set */</span><br><span class="line">   #if __IPHONE_OS_VERSION_MIN_REQUIRED &lt; __IPHONE_2_0</span><br><span class="line">       #undef __IPHONE_OS_VERSION_MIN_REQUIRED</span><br><span class="line">       #define __IPHONE_OS_VERSION_MIN_REQUIRED    __IPHONE_2_0 </span><br><span class="line">   #endif</span><br></pre></td></tr></table></figure>
<p>我查看的是iOS 9.0的定义，里面定义 <code>__IPHONE_OS_VERSION_MAX_ALLOWED</code> 为 <code>__IPHONE_9_0</code>(90000)</p>
<p>相信每个iOS SDK发布，都会增加 一个宏来表示版本号</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_2_0     20000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_2_1     20100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_2_2     20200</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_3_0     30000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_3_1     30100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_3_2     30200</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_4_0     40000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_4_1     40100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_4_2     40200</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_4_3     40300</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_5_0     50000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_5_1     50100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_6_0     60000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_6_1     60100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_7_0     70000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_7_1     70100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_8_0     80000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_8_1     80100</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_8_2     80200</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_8_3     80300</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_8_4     80400</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __IPHONE_9_0     90000</span></span><br><span class="line"><span class="comment">/* __IPHONE_NA is not defined to a value but is uses as a token by macros to indicate that the API is unavailable */</span></span><br></pre></td></tr></table></figure>
<p>问题来了：如果兼容代码中使用的 宏定义为 <code>__IPHONE_8_4</code> ，而我编译的iOS SDK使用的是 iOS8.3的话， <code>__IPHONE_8_4</code> 其实是没定义的。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> __IPHONE_OS_VERSION_MAX_ALLOWED &gt; __IPHONE_8_4</span></span><br></pre></td></tr></table></figure>
<p>这个比较语句其实取 <code>__IPHONE_OS_VERSION_MAX_ALLOWED</code> = <code>__IPHONE_8_3</code> = 80300 和 <code>__IPHONE_8_4</code> 所表示的数字做比较，是没有作用的。正确做法 <strong>是直接使用数字</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> __IPHONE_OS_VERSION_MAX_ALLOWED &gt; 80400</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2015-10-01-Regular-Expression-Matching" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/01/2015-10-01-Regular-Expression-Matching/">Regular Expression Matching</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/10/01/2015-10-01-Regular-Expression-Matching/" class="article-date">
  <time datetime="2015-10-01T00:00:00.000Z" itemprop="datePublished">2015-10-01</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a><span>></span><a class="article-category-link" href="/categories/Algorithm/LeetCode/">LeetCode</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://leetcode.com/problems/regular-expression-matching/" target="_blank" rel="external">https://leetcode.com/problems/regular-expression-matching/</a></p>
<p>这个题目比较有意思，大意是实现正则表达式中的’*’和’.’这种两种操作符。</p>
<p>我们来看看 这两种操作符是做什么的</p>
<blockquote>
<p>‘.’ Matches any single character.</p>
<p>‘*’ Matches zero or more of the preceding element.</p>
</blockquote>
<p>意思是说，’.’这个操作符能匹配任意单个字符，’*‘ 这个操作符能匹配 <strong>任意次</strong> 在它前面的符号。恩，看起来’*‘是压缩连续字符串的。</p>
<p>我们再看看题目中的几个case，分析一下最后三个吧：</p>
<blockquote>
<p>case 1 isMatch(“aa”, “.*”) → true </p>
<p>case 2 isMatch(“ab”, “.*”) → true </p>
<p>case 3 isMatch(“aab”, “c<em>a</em>b”) → true </p>
</blockquote>
<p>case 1比较好理解，’.’匹配第一个’a’，’*‘匹配了第二个’a’. 因为 ‘*‘前面一个字符是’a’</p>
<p>case 2 这个case，我一开始一直理解不了，一度以为是题目搞错了。重新读题的时候，才发现题意说的很明白，是我误解了题意。</p>
<p><strong>‘*‘ Matches zero or more of the preceding element.</strong></p>
<p>反复理解这句话，意思是指’*‘能表示任意个在它前面的字符。也就是说，它前面如果是’.’这种操作符的话，”.*“可以是”.”,”..”,”…”。</p>
<p>那么，之前case 1的理解也是错的，’*‘操作符的优先级比较高，匹配时要优先考虑’*‘的存在。</p>
<p>case 1应该是这么理解 先是’*‘表示了一个在它前面的’.’，使得模式串变成了”..”，最后再去匹配。</p>
<p>case 2也能这么解释。 </p>
<p>case 3，第一个’*‘的存在把前面的’c’表示了0次，第二个’*‘的存在把前面的’a’表示了两次，把模式串变成了”aab”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">bool isMatch(char* s, char* p) &#123;</span><br><span class="line">    if(*p == 0) return *s == 0;</span><br><span class="line">    /**</span><br><span class="line">     *  因为 &apos;*&apos;优先级较高,且影响前一个字符。所以优先考虑&apos;*&apos;存在的情况</span><br><span class="line">     *  如果 当前字符的下一个字符不是 &apos;*&apos;的话, 进行正常的匹配。 注意&apos;.&apos;的情况。</span><br><span class="line">     */</span><br><span class="line">    if(*(p+1) != &apos;*&apos;)&#123;</span><br><span class="line">        // 当前字符匹配成功的条件是 *s 存在 且 *s和*p相同</span><br><span class="line">        if(*s &amp;&amp; ((*s == *p) || (*p == &apos;.&apos;)))&#123;</span><br><span class="line">            return isMatch(s+1,p+1);</span><br><span class="line">        &#125;</span><br><span class="line">        // 当前字符匹配不通过，无须匹配后面的字符了。</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        // 枚举 &apos;*&apos;操作符 表示n次当前字符,直到当前字符失效(失效的意思就是说 &apos;*&apos;影响当前字符的所有情况都我们枚举过了,不能考虑&apos;*&apos;的意义了,做下一步工作吧)</span><br><span class="line">        while(*s &amp;&amp; ((*s==*p) || (*p == &apos;.&apos;)))&#123;</span><br><span class="line">            if(isMatch(s, p+2)) return true;</span><br><span class="line">            s++;</span><br><span class="line">        &#125;</span><br><span class="line">        // 放弃这个 &apos;*&apos;操作符的机会，也就是说&apos;*&apos;表示了前一次字符0次。</span><br><span class="line">        return isMatch(s, p+2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/Regular%20Expression%20Matching.png" alt="Regular Expression Matching Accepted"></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LeetCode/">LeetCode</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2015-10-01-Make-Your-App-Searchable" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/01/2015-10-01-Make-Your-App-Searchable/">Make Your App Searchable</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/10/01/2015-10-01-Make-Your-App-Searchable/" class="article-date">
  <time datetime="2015-10-01T00:00:00.000Z" itemprop="datePublished">2015-10-01</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://48ce6c28e7bf5f42a1b7-2712e00ea34e3076747650c92426bbb5.ssl.cf1.rackcdn.com/2015-06-17-013455.jpeg" alt="1"></p>
<p><img src="http://searchengineland.com/figz/wp-content/seloads/2015/06/iOS-9-Apple-Search-Indexing-Methods-800x553-800x553.png" alt="2"></p>
<ul>
<li><a href="https://developer.apple.com/library/prerelease/ios/technotes/tn2416/_index.html#//apple_ref/doc/uid/DTS40016269-CH1-SEARCH_API_FAQ-WHICH_IS_THE_RIGHT_API_FOR_ME_TO_USE_" target="_blank" rel="external">官方FAQ</a></li>
</ul>
<p><strong>How Does Apple Rank Apps In Apple Search?</strong></p>
<p><strong>Positive Ranking Factors</strong></p>
<ul>
<li><strong>App Installation Status.</strong> Is the app is installed on the device? (installed apps seem to get preference)</li>
<li><strong>Personalized App Engagement.</strong> Does the individual engage with the screen in the app? This is based on time spent with result that Apple determines from session analytics.</li>
<li><strong>App Result Click-Through Rate.</strong> Do users frequently click through the search result vs. picking another result or searching again?</li>
<li><strong>Keywords/ Title.</strong> Do keywords from the “keywords” and “title” designations in the app markup match up with the user’s query?</li>
<li><strong>Aggregated Engagement.</strong> How many users engage with the app screen?</li>
<li><strong>Structured Data on Web.</strong> Is structured data correctly implemented?</li>
<li><strong>Canonical App IDs.</strong> Is the same screen associated with one unique ID or URL across multiple indexing methods (NSUserActivity, CoreSpotlight, and Web Markup)?</li>
<li><strong>Strength/Popularity of Web URL.</strong> How popular is the website associated with the app deep links? (Presumably, this is based on Applebot’s crawl.)</li>
</ul>
<p><strong>Negative Ranking Factors</strong></p>
<ul>
<li><strong>Low Engagement.</strong> Do very few users engage with the app screen? (engagement determined by session analytics)</li>
<li><strong>Over-Indexing.</strong> Does the app have many screens in the index with low or no engagement?</li>
<li><strong>Returns.</strong> Do users return to search results right after looking at the app?</li>
<li><strong>Keywords Spamming.</strong> Are developers stuffing too many irrelevant keywords into the keyword field?</li>
<li><strong>Interstitials.</strong> Is something covering the content in the app or preventing users from accessing it?</li>
<li><strong>Javascript (web only).</strong> Is Javascript preventing Applebot from crawling your site to find new app deep links?</li>
<li><strong>Low Star Ratings, Low Review Volume, Poor Reviews.</strong> Apple has not explicitly called these negative ranking factors for Apple Search, but they are negative ranking factors for the App Store, so we expect Apple to treat them similarly here.</li>
</ul>
<p>Apple recommends pursuing multiple indexing methods to optimize app visibility, but the overlapping methods will inevitably create duplication across the various indexes. For example, private content could have both a NSUserActivity and CSSearchableItem indexed, and public content could have both a NSUserActivity and a Web Markup deep link indexed.</p>
<p>This is obviously not ideal for controlling Applebot’s efficiency, so Apple strongly recommends associating each NSUserActivity, CSSearchableItem, and Web Markup deep link with the same uniqueIdentifier and/or URL. This is Applebot’s version of a canonical, and it’s so important to Apple that they’ve even made it a ranking factor in the Apple Search algorithm.</p>
<p><a href="https://developer.apple.com/library/prerelease/ios/documentation/CoreSpotlight/Reference/CoreSpotlight_Framework/" target="_blank" rel="external">CoreSpotlight Framework</a></p>
<p><a href="http://applidium.com/en/news/ios9_search_api/" target="_blank" rel="external">How to use the new search API</a></p>
<blockquote>
<p>如有任何知识产权、版权问题或理论错误，还请指正</p>
<p>转载请注明原作者及以上信息</p>
</blockquote>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Core-Spotlight/">Core Spotlight</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2015-09-06-Permutation- Sequence" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/09/06/2015-09-06-Permutation- Sequence/">Permutation Sequence</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2015/09/06/2015-09-06-Permutation- Sequence/" class="article-date">
  <time datetime="2015-09-06T00:00:00.000Z" itemprop="datePublished">2015-09-06</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a><span>></span><a class="article-category-link" href="/categories/Algorithm/LeetCode/">LeetCode</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://leetcode.com/problems/permutation-sequence/" target="_blank" rel="external">Permutation Sequence</a></p>
<p>题目大意：一个[1,2,3,…,n]n个数字的集合有 n！个唯一的排列组合。对这些排列组合排序我们能得到一个有序的数组，现在给你一个n和k求第k个顺序的排列。</p>
<p>ie，for n = 3，k = 4</p>
<ol>
<li>“123”</li>
<li>“132”</li>
<li>“213”</li>
<li>“231”</li>
<li>“312”</li>
<li>“321”</li>
</ol>
<p>应该返回第4个排列情况”231”。</p>
<p><strong>Note</strong> 给定的n在[1,9]之间</p>
<p>解题思路：一开始我使用C++ STL自带的next_permutation API,以为能水过去。结果超时了(Time Limit Exceeded) 看来不能偷懒。</p>
<p>我们来重新看一下题目，n个数字有n！种排列情况，求第k个排列组合(排序之后)。大致能理解为 给n个数字，组成第k小的数。 这么想的话，我们可以思考一下 如果有n个数，求组成第k小的数，我们第一位数字应该如何选择呢？</p>
<p>还是这个(n = 3, k = 4)的case，我们手上有1，2，3这三个数字，我们要组成第4小的数，我们第一个数字应该选2，为什么选2需要解释一下：</p>
<p>我们要组成第4小的数，手上有3个数，有3！= 6种排列情况(组成情况)。要先选一个最高位数， 我们看一下 剩下有2个数，有2种组成情况。显然最高位选1的话，最多也是一个第2小的数。选3的话，怎么组成也是第5小的数起跳。选2的话，组成的数区间是第4-第5。所以我们选择2作为 第4小的数的最高位。</p>
<p>由此规律为：最高位数字是 (k-1)/(n-1)！<br>同理 选择次最高位思路是一样的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">public:</span><br><span class="line">    string getPermutation(int n, int k) &#123;</span><br><span class="line">        </span><br><span class="line">        string str = &quot;&quot;;</span><br><span class="line">        if(k == factorial(n))&#123;</span><br><span class="line">            for(int i=n;i&gt;0;i--) str+=(&apos;0&apos;+i);</span><br><span class="line">            return str;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        vector&lt;int&gt; numbers;</span><br><span class="line">        for(int i=1;i&lt;=n;i++) numbers.push_back(i);</span><br><span class="line">        for(int i=1;i&lt;n;i++)&#123;</span><br><span class="line">            int num = factorial(n-i);</span><br><span class="line">            int index = (k-1)/num;</span><br><span class="line">            str += (&apos;0&apos; + numbers[index]);</span><br><span class="line">            numbers.erase(numbers.begin() + index);</span><br><span class="line">            k = k-index*num;</span><br><span class="line">        &#125;</span><br><span class="line">        str+= (&apos;0&apos; + numbers[0]);</span><br><span class="line">        return str;</span><br><span class="line">    &#125;</span><br><span class="line">private:</span><br><span class="line">    int factorial(int n)&#123;</span><br><span class="line">        int ans = n;</span><br><span class="line">        while(--n) ans*=n;</span><br><span class="line">        return ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/Permutation%20Sequence.png" alt="accepted"></p>
<blockquote>
<p>如有任何知识产权、版权问题或理论错误，还请指正。</p>
<p>转载请注明原作者及以上信息。</p>
</blockquote>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LeetCode/">LeetCode</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
      </nav>
    </section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 miaoyou.gmy&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
</html>