<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>778477</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="778477">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="778477">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="778477">
<meta name="twitter:description">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo logo-text" href="/">778477</a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
        </div>
      </nav>
    </div>
  </div>
</header>
    <section id="main" class="outer">
      <article id="post-2017-04-24-iClean" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/20/2017-04-24-iClean/">iClean</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/04/20/2017-04-24-iClean/" class="article-date">
  <time datetime="2017-04-20T00:00:00.000Z" itemprop="datePublished">2017-04-20</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/macOS/">macOS</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>令人费解的AppKit</p>
<h2 id="脱离nib-和-storyboard-开发方式"><a href="#脱离nib-和-storyboard-开发方式" class="headerlink" title="脱离nib 和 storyboard 开发方式"></a>脱离nib 和 storyboard 开发方式</h2><p> nib和storyboard 千好万好。但在多人开发模式下，修改同一份storyborad，产生的冲突简直是灾难。</p>
<p>干掉项目中<code>info.plist</code> 关于<code>Main.storyboard</code>的设置。在<code>main.m</code>中手动绑定<code>AppDelegate</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;Cocoa/Cocoa.h&gt;</span><br><span class="line">#import &quot;AppDelegate.h&quot;</span><br><span class="line">int main(int argc, const char * argv[]) &#123;</span><br><span class="line">    AppDelegate *app = [[AppDelegate alloc] init];</span><br><span class="line">    [NSApplication sharedApplication].delegate = app;</span><br><span class="line">    return NSApplicationMain(argc, argv);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>按照<code>iOS</code>的开发经验，<code>Window</code>下要放置一个<code>ViewController</code>。需要注意的是重写<code>loadview</code>方法不要调用<code>super</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Instantiates a view from a nib file and sets the value of the view property.</span><br></pre></td></tr></table></figure>
<p><code>super</code>会去加载同名的<code>nib</code>文件。正确的纯编码方式是不调用父类方法，再自己设置一个<code>NSView</code>即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (void)loadView&#123;</span><br><span class="line">    self.view = [[NSView alloc] initWithFrame:NSMakeRect(0, 0, iCleanMainWindowWidth, iCleanMainWindowHeight)];</span><br><span class="line">    self.view.wantsLayer = YES;</span><br><span class="line">    self.view.layer.backgroundColor = [NSColor brownColor].CGColor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="NSTableView"><a href="#NSTableView" class="headerlink" title="NSTableView"></a>NSTableView</h2><p>编码使用<code>NSTableView</code>的话，要配置使用<code>NSScorllView</code> 和 <code>NSTableColumn</code>。 具体实践是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">_scrollView = [[NSScrollView alloc] initWithFrame:NSMakeRect(iCleanMainWindowWidth - 400, 0, 400, iCleanMainWindowHeight)];</span><br><span class="line">_scrollView.hasVerticalScroller = _scrollView.hasVerticalRuler = YES;</span><br><span class="line">_scrollView.hasHorizontalScroller = _scrollView.hasHorizontalRuler = NO;</span><br><span class="line">        </span><br><span class="line">_tableView = [[NSTableView alloc] initWithFrame:_scrollView.bounds];</span><br><span class="line">_tableView.delegate = self;</span><br><span class="line">_tableView.dataSource = self;</span><br><span class="line">_tableView.headerView = nil;</span><br><span class="line">_scrollView.contentView.documentView = _tableView;</span><br><span class="line">        </span><br><span class="line">NSTableColumn *col = [[NSTableColumn alloc] initWithIdentifier:@&quot;col1&quot;];</span><br><span class="line">col.minWidth = 400;</span><br><span class="line">[_tableView addTableColumn:col];</span><br></pre></td></tr></table></figure>
<p>其中<code>NSTableDataSource</code> 和 <code>NSTableViewDelegate</code> 虽然都是<code>optional</code>的办法。但仍需要实现下面的方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - NSTableViewDelegate</span><br><span class="line">- (NSView *)tableView:(NSTableView *)tableView viewForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row&#123;</span><br><span class="line">    NSTextField *cell = [tableView makeViewWithIdentifier:@&quot;cellReuseId&quot; owner:self];</span><br><span class="line">    if(!cell)&#123;</span><br><span class="line">        cell = [NSTextField labelWithString:@&quot;&quot;];</span><br><span class="line">        cell.identifier = @&quot;cellReuseId&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    NSMutableAttributedString *str = [[NSMutableAttributedString alloc] initWithString:[NSString stringWithFormat:@&quot;%@ \n%@&quot;,self.data[row].path.lastPathComponent,self.data[row].formatSize] attributes:@&#123;NSForegroundColorAttributeName:[NSColor blackColor]&#125;];</span><br><span class="line">    </span><br><span class="line">    cell.placeholderAttributedString = str;</span><br><span class="line">    return cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (CGFloat)tableView:(NSTableView *)tableView heightOfRow:(NSInteger)row&#123;</span><br><span class="line">    return 50.f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)tableViewSelectionDidChange:(NSNotification *)notification&#123;</span><br><span class="line">    NSInteger row = [[notification object] selectedRow];</span><br><span class="line">    NSLog(@&quot;%ld&quot;,row);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#pragma mark - NSTableViewDataSource</span><br><span class="line">- (NSInteger)numberOfRowsInTableView:(NSTableView *)tableView&#123;</span><br><span class="line">    return self.data.count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意是 <code>AppKit</code>里面是没有<code>Label</code>控件的，我这是使用的是<code>NSTextField</code>。就是输入框了，借助<code>placeholderString</code>属性能实现文本展示的效果。</p>
<p><img src="../img/iClean-snapshot1.png" alt="tt"></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cocoa/">cocoa</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2017-04-20-iClean 一款Mac OS 软件的诞生" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/20/2017-04-20-iClean 一款Mac OS 软件的诞生/">iClean 一款Mac OS 软件的诞生</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/04/20/2017-04-20-iClean 一款Mac OS 软件的诞生/" class="article-date">
  <time datetime="2017-04-20T00:00:00.000Z" itemprop="datePublished">2017-04-20</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/macOS/">macOS</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>我工作用的Mac Pro是256GB ssd硬盘。开发iOS久了，经常提示磁盘空间不够，其中最大原因是来自Xcode®</p>
<p>可以打开 <code>~/Library/Developer/Xcode/DerivedData</code> 看看，这里存放了Xcode编译构建过的所有项目工程数据。</p>
<p>这如 <code>watchdog</code> 磁盘清理软件描述提及的那样 <code>automatically cleans up stale cache files</code>。将陈腐失效的缓存数据及时清理掉，你的ssd硬盘可用空间就多起来了。</p>
<p>作为一个要强的iOS开发工程师，自己能做的东西，为什么要用别人的？</p>
<p>所以，我确定做一款自己的磁盘清理软件</p>
<blockquote>
<p><a href="https://www.cerebralgardens.com/watchdog" target="_blank" rel="external">watchdog for Xcode</a></p>
</blockquote>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cocoa/">cocoa</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2017-03-07-TinyURL的生成" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/07/2017-03-07-TinyURL的生成/">TinyURL的生成</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/03/07/2017-03-07-TinyURL的生成/" class="article-date">
  <time datetime="2017-03-07T00:00:00.000Z" itemprop="datePublished">2017-03-07</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a><span>></span><a class="article-category-link" href="/categories/Algorithm/Hash/">Hash</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://leetcode.com/problems/encode-and-decode-tinyurl/?tab=Description" target="_blank" rel="external">Encode and Decode TinyURL</a></p>
<p>这题很有意思。</p>
<p>题目大意是实现一个长链接和短链接的转化。</p>
<p>形式是 <a href="http://tinyurl.com/4e9iAk。" target="_blank" rel="external">http://tinyurl.com/4e9iAk。</a> 只有6位标志包含(0-9),(a-z),(A-Z)</p>
<p>一位有10+26+26 = 62种值。 6位的总数大致是 62^6 - 1。</p>
<h3 id="思路1-哈希"><a href="#思路1-哈希" class="headerlink" title="思路1. 哈希"></a>思路1. 哈希</h3><p>既然我们想到了hash，就需要搞明白 URL的字符集，就是说URL中有可能会出现哪些字符。发现题目不控制长链接的长度，再加上URL的字符集也超过了62种。只有6位的话，再高明的hash也难免冲突</p>
<h3 id="思路2-自增ID"><a href="#思路2-自增ID" class="headerlink" title="思路2. 自增ID"></a>思路2. 自增ID</h3><p>62^6次 大约为 2^32 左右。能发放2^32个ID。</p>
<p>自增的问题在于不可逆。</p>
<p>短链无法逆算出长链，存在这个需求的话需要将ID和长链接关联存储起来。</p>
<p>自增在单点服务器上需要加锁，避免多线程访问ID重复。hash没有这个问题，hash算法保证唯一性。加锁QPS高的情况下，会出现排队等待的情况。分布式支持高QPS，不考虑分布式锁同步的话：</p>
<p>有这种的思路：发单双号ID。A服务器只发单号，B服务器只发双号。类比你集群有多少台服务器。</p>
<p><a href="https://raw.githubusercontent.com/778477/LeetCode/master/00535.%20Encode%20and%20Decode%20TinyURL.cpp" target="_blank" rel="external">Raw 535. Encode and Decode TinyURL.cpp</a></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/">Algorithm</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2017-02-27-WebSocket" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/27/2017-02-27-WebSocket/">WebSocket</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/02/27/2017-02-27-WebSocket/" class="article-date">
  <time datetime="2017-02-27T00:00:00.000Z" itemprop="datePublished">2017-02-27</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/NetWork/">NetWork</a><span>></span><a class="article-category-link" href="/categories/NetWork/WebSocket/">WebSocket</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li><a href="#背景">背景</a></li>
<li><a href="#握手协议">握手协议</a></li>
<li><a href="#数据帧">数据帧</a></li>
<li><a href="#掩码存在的必要性">掩码存在的必要性</a></li>
<li><a href="#引用">引用</a></li>
</ul>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>现在，很多网站为了实现推送技术，所用的技术都是轮询。轮询是在特定的的时间间隔（如每1秒），由浏览器对服务器发出HTTP请求，然后由服务器返回最新的数据给客户端的浏览器。这种传统的模式带来很明显的缺点，即浏览器需要不断的向服务器发出请求，然而HTTP请求可能包含较长的头部，其中真正有效的数据可能只是很小的一部分，显然这样会浪费很多的带宽等资源。</p>
<p>而比较新的技术去做轮询的效果是Comet。这种技术虽然可以双向通信，但依然需要反复发出请求。而且在Comet中，普遍采用的长链接，也会消耗服务器资源。</p>
<p>在这种情况下，HTML5定义了WebSocket协议，能更好的节省服务器资源和带宽，并且能够更实时地进行通讯。</p>
<h2 id="握手协议"><a href="#握手协议" class="headerlink" title="握手协议"></a>握手协议</h2><p><code>WebSocket</code>是独立，建立在<code>TCP</code>上的协议。</p>
<p>和<code>HTTP</code>的关系是，<code>WebSocket</code>第一次的握手请求是使用<code>HTTP</code>协议：</p>
<p>一个典型的握手请求请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Host: example.com</span><br><span class="line">Origin: http://example.com</span><br><span class="line">Sec-WebSocket-Key: sN9cRrP/n9NdMgdcy2VJFQ==</span><br><span class="line">Sec-WebSocket-Version: 13</span><br></pre></td></tr></table></figure>
<p>服务端回应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 101 Switching Protocols</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Sec-WebSocket-Accept: fFBooB7FAkLlXgRSz0BT3v4hq5s=</span><br><span class="line">Sec-WebSocket-Location: ws://example.com/</span><br></pre></td></tr></table></figure>
<p>字段说明</p>
<ul>
<li>Connection必须设置Upgrade，表示客户端希望连接升级。</li>
<li>Upgrade字段必须设置Websocket，表示希望升级到Websocket协议。</li>
<li>Sec-WebSocket-Key是随机的字符串，服务器端会用这些数据来构造出一个SHA-1的信息摘要。把“Sec-WebSocket-Key”加上一个特殊字符串“258EAFA5-E914-47DA-95CA-C5AB0DC85B11”，然后计算SHA-1摘要，之后进行BASE-64编码，将结果做为“Sec-WebSocket-Accept”头的值，返回给客户端。如此操作，可以尽量避免普通HTTP请求被误认为Websocket协议。</li>
<li>Sec-WebSocket-Version 表示支持的Websocket版本。RFC6455要求使用的版本是13，之前草案的版本均应当被弃用。</li>
<li>Origin字段是可选的，通常用来表示在浏览器中发起此Websocket连接所在的页面，类似于Referer。但是，于Referer不同的是，Origin只包含了协议和主机名称。</li>
<li>其他一些定义在HTTP协议中的字段，如Cookie等，也可以在Websocket中使用。</li>
</ul>
<p>客户端发送握手请求，要求服务端升级协议。服务端再回复<code>HTTP/1.1 101 Switching Protocols</code>。 自此双通道已搭建，两端使用发送序列化的数据帧传输数据</p>
<p>除此之外，WebSocket也规定了加密数据传输方法，允许使用TLS/SSL对通信进行加密，类似HTTPS。默认情况下，ws协议使用80端口进行普通连接，加密的TLS连接默认使用443端口。</p>
<h2 id="数据帧"><a href="#数据帧" class="headerlink" title="数据帧"></a>数据帧</h2><p>出于安全原因考虑。不管<code>WebSocket</code>协议是否基于<code>TLS</code>上，客户端发送的数据帧中必须包含掩码。</p>
<ol>
<li>客户端向服务器传输的数据帧必须进行掩码处理：服务器若接收到未经过掩码处理的数据帧，则必须主动关闭连接。</li>
<li>服务器向客户端传输的数据帧一定不能进行掩码处理。客户端若接收到经过掩码处理的数据帧，则必须主动关闭连接。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">0               1               2               3                &lt;- byte</span><br><span class="line">0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7  &lt;- bit</span><br><span class="line">+-+-+-+-+-------+-+-------------+-----------------------------+</span><br><span class="line">|F|R|R|R| Opcode|M| Payload len |    Extended payload length  |</span><br><span class="line">|I|S|S|S|  (4)  |A|     (7)     |             (16/64)         |</span><br><span class="line">|N|V|V|V|       |S|             |   (if payload len==126/127) |</span><br><span class="line">| |1|2|3|       |K|             |                             |</span><br><span class="line">+-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - +</span><br><span class="line">|   Extended payload length continued, if payload len == 127  |</span><br><span class="line">+ - - - - - - - - - - - - - - - +-----------------------------+</span><br><span class="line">|                               |Masking-key, if MASK set to 1|</span><br><span class="line">+-------------------------------+-----------------------------+</span><br><span class="line">| Masking-key (continued)       |          Payload Data       |</span><br><span class="line">+-------------------------------- - - - - - - - - - - - - - - +</span><br><span class="line">:                     Payload Data continued ...              :</span><br><span class="line">+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +</span><br><span class="line">|                     Payload Data continued ...              |</span><br><span class="line">+-------------------------------------------------------------+</span><br></pre></td></tr></table></figure>
<p><code>FIN</code>占<code>1 bit</code> 指示这个是消息的最后片段。</p>
<p><code>RSV1,RSV2,RSV3</code>各占<code>1 bit</code> 扩展协议非零值定义，一般为0。</p>
<p><code>Opcode</code>操作码，占<code>4 bit</code>定义<code>payload Data</code>的意义。</p>
<ul>
<li>%x0 代表一个继续帧</li>
<li>%x0 代表一个继续帧</li>
<li>%x1 代表一个文本帧</li>
<li>%x2 代表一个二进制帧</li>
<li>%x3-7 保留用于未来的非控制帧</li>
<li>%x8 代表连接关闭</li>
<li>%x9 代表ping</li>
<li>%xA 代表pong</li>
<li>%xB-F 保留用于未来的控制帧</li>
</ul>
<p><code>Mask</code>是否存在掩码标志位，占<code>1 bit</code>。若为1，则<code>Masking-key</code>存在掩码。客户端发送的数据帧中必须为1</p>
<p><code>Payload length</code>负载数据长度。占<code>7 bits</code>，且最高有效位必须为0。所以<code>7 bits</code>只能表示0~127（2^7 - 1),若值为0~125则表示<code>7 bits</code>是有效负载数据长度。若值为126，则表示需要查看后<code>16 bits</code>。若值为127，则表示需要查看后面<code>64 bits</code>。</p>
<p><code>Masking-key</code> 客户端发送数据帧的掩码</p>
<p><code>payload Data</code> 应用数据</p>
<h2 id="掩码存在的必要性"><a href="#掩码存在的必要性" class="headerlink" title="掩码存在的必要性"></a>掩码存在的必要性</h2><p>掩码是由客户端随机选择的32位值。 客户端必须从允许的32位值集合中选择一个新的掩码。 掩码需要是不可预测的；因此，掩码键必须来自一个强大的熵源，且用于给定帧的掩码键必须不容易被服务器/代理预测用于后续帧的掩码键。 </p>
<p>掩码键的不可预测性对防止恶意应用的作者选择出现在报文上的字节是必要的。 </p>
<h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p><a href="https://tools.ietf.org/rfc/rfc6455.txt" target="_blank" rel="external">The WebSocket Protocol</a><br><a href="https://chenjianlong.gitbooks.io/rfc-6455-websocket-protocol-in-chinese/content/section3/section3.html" target="_blank" rel="external">The WebSocket Protocol 中文版</a></p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WebSocket/">WebSocket</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2017-02-21-iOS runtime浅析Property和Ivar" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/21/2017-02-21-iOS runtime浅析Property和Ivar/">iOS runtime浅析Property和Ivar</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/02/21/2017-02-21-iOS runtime浅析Property和Ivar/" class="article-date">
  <time datetime="2017-02-21T00:00:00.000Z" itemprop="datePublished">2017-02-21</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a><span>></span><a class="article-category-link" href="/categories/iOS/runtime/">runtime</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Property"><a href="#Property" class="headerlink" title="Property"></a>Property</h2><p><code>property</code> 是<code>Objective-C</code>的一个语法糖，能帮助你声明成员变量<code>(ivar)</code>(自动声明的变量名前面会加下划线)+自动生成对应属性特性<code>(atomic/nonatomic/copy/strong/weak/assign...)</code>的<code>setter</code>和<code>getter</code></p>
<p>通常我们在编写iOS程序的时候声明类的成员变量，习惯使用<code>property</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">//  GMYTestObject.h</span><br><span class="line">//  ObjectInspector</span><br><span class="line">//</span><br><span class="line">//  Created by miaoyou.gmy on 2017/2/22.</span><br><span class="line">//  Copyright © 2017年 miaoyou.gmy. All rights reserved.</span><br><span class="line">//</span><br><span class="line">@interface GMYTestObject : NSObject</span><br><span class="line">@property (nonatomic, assign) NSUInteger index;</span><br><span class="line">@property (nonatomic, copy) NSString *str;</span><br><span class="line">@property (nonatomic, copy) NSArray *array;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>对应自动声明的<code>_index</code>，<code>_str</code>，<code>_array</code></p>
<p>若想声明<code>private</code>的成员变量要借助<code>Class Extensions</code>在原有的实现文件中添加变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">//  GMYTestObject.m</span><br><span class="line">//  ObjectInspector</span><br><span class="line">//</span><br><span class="line">//  Created by miaoyou.gmy on 2017/2/22.</span><br><span class="line">//  Copyright © 2017年 miaoyou.gmy. All rights reserved.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#import &quot;GMYTestObject.h&quot;</span><br><span class="line"></span><br><span class="line">@interface GMYTestObject ()</span><br><span class="line">@property (nonatomic, copy) NSString *testStr;</span><br><span class="line">@property (nonatomic, assign) CGFloat margin;</span><br><span class="line">@property (nonatomic, copy) NSDictionary *dict;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation GMYTestObject</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>这个技巧可以参阅<a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/CustomizingExistingClasses/CustomizingExistingClasses.html" target="_blank" rel="external">Class Extensions Extend the Internal Implementation</a></p>
<h3 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h3><p><code>property</code>在早些年是不支持声明类变量的。直到2016年Xcode8发布和更新了LLVM，才支持。<br><a href="https://developer.apple.com/videos/play/wwdc2016/405/" target="_blank" rel="external">WWDC 2016 Session 405 What’s New in LLVM</a></p>
<p>From the Xcode 8 release notes:</p>
<blockquote>
<p>Objective-C now supports class properties, which interoperate with Swift type properties. They are declared as: @property (class) NSString *someStringProperty;. They are never synthesized. (23891898)</p>
</blockquote>
<p>额外要注意是，使用<code>property</code>声明类变量是不会自动合成<code>setter</code> 和 <code>getter</code> 的。<strong>They are never synthesized.</strong></p>
<p>要使用这个特性的具体实践是：<br>在 <code>.h</code>头文件中声明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">//  GMYTestObject.h</span><br><span class="line">//  ObjectInspector</span><br><span class="line">//</span><br><span class="line">//  Created by miaoyou.gmy on 2017/2/22.</span><br><span class="line">//  Copyright © 2017年 miaoyou.gmy. All rights reserved.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line">@interface GMYTestObject : NSObject</span><br><span class="line">@property (class, nonatomic, assign) NSUInteger instanceCount;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>在<code>.m</code>实现文件中声明<code>setter</code>和<code>getter</code> + 声明<code>static 同类型</code>类变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">//  GMYTestObject.m</span><br><span class="line">//  ObjectInspector</span><br><span class="line">//</span><br><span class="line">//  Created by miaoyou.gmy on 2017/2/22.</span><br><span class="line">//  Copyright © 2017年 miaoyou.gmy. All rights reserved.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#import &quot;GMYTestObject.h&quot;</span><br><span class="line">@implementation GMYTestObject</span><br><span class="line">static NSUInteger _instanceCount = 0;</span><br><span class="line">+ (NSUInteger)instanceCount&#123;</span><br><span class="line">    return _instanceCount;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (void)setInstanceCount:(NSUInteger)instanceCount&#123;</span><br><span class="line">    _instanceCount = instanceCount; //  重复声明一个类变量是为了实现setter,加_是自有成员变量的传统命名规则</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h2 id="Ivar"><a href="#Ivar" class="headerlink" title="Ivar"></a>Ivar</h2><p><code>Property</code>是<code>Ivar</code>+<code>synthesized setter</code> + <code>synthesized getter</code> 的语法糖<br><code>Ivar</code>指的就是instance variables</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@interface GMYTestObject : NSObject&#123;</span><br><span class="line">@public</span><br><span class="line">    NSUInteger _index;</span><br><span class="line">    NSString *_str;</span><br><span class="line">    NSArray *_array;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>没有自动合成的<code>setter</code> 和 <code>getter</code>方法。在OOP的封装概念下显得不那么讨喜，渐渐被<code>Property</code>取代。</p>
<p>“原始”的<code>Ivar</code>声明方式也有不少好处：<a href="http://stackoverflow.com/questions/9086736/why-would-you-use-an-ivar" target="_blank" rel="external">why-would-you-use-an-ivar</a></p>
<h2 id="runtime"><a href="#runtime" class="headerlink" title="runtime"></a>runtime</h2><p>我们再来聊聊如何借助iOS的动态性，获取一个对象的所有成员变量。</p>
<p>在<code>&lt;objc/runtime.h&gt;</code>中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// Describes the properties declared by a class.</span><br><span class="line"></span><br><span class="line">OBJC_EXPORT objc_property_t *class_copyPropertyList(Class cls, unsigned int *outCount)</span><br><span class="line">    OBJC_AVAILABLE(10.5, 2.0, 9.0, 1.0);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// Describes the instance variables declared by a class.</span><br><span class="line"></span><br><span class="line">OBJC_EXPORT Ivar *class_copyIvarList(Class cls, unsigned int *outCount) </span><br><span class="line">    OBJC_AVAILABLE(10.5, 2.0, 9.0, 1.0);</span><br></pre></td></tr></table></figure>
<p>根据<code>Property</code> 和 <code>Ivar</code> 的关系可知。我们使用<code>class_copyIvarList</code>就能获取到所有对象成员变量，包括使用原始声明方式声明的变量。</p>
<p>我们再看看有什么和<code>Ivar</code>相关的API</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//Returns the name of an instance variable.</span><br><span class="line">OBJC_EXPORT const char *ivar_getName(Ivar v);</span><br><span class="line">    </span><br><span class="line">//Returns the type string of an instance variable. </span><br><span class="line">OBJC_EXPORT const char *ivar_getTypeEncoding(Ivar v);</span><br><span class="line"></span><br><span class="line">//Returns the offset of an instance variable.</span><br><span class="line">OBJC_EXPORT ptrdiff_t ivar_getOffset(Ivar v); </span><br><span class="line">    </span><br><span class="line">//Reads the value of an instance variable in an object.</span><br><span class="line">OBJC_EXPORT id object_getIvar(id obj, Ivar ivar);</span><br><span class="line"></span><br><span class="line">//Sets the value of an instance variable in an object.</span><br><span class="line">OBJC_EXPORT void object_setIvar(id obj, Ivar ivar, id value);</span><br></pre></td></tr></table></figure>
<p>定义<code>GMYTestObject</code>作用测试各个类型的成员变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">//  GMYTestObject.h</span><br><span class="line">//  ObjectInspector</span><br><span class="line">//</span><br><span class="line">//  Created by miaoyou.gmy on 2017/2/22.</span><br><span class="line">//  Copyright © 2017年 miaoyou.gmy. All rights reserved.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">typedef enum&#123;</span><br><span class="line">    TestA,</span><br><span class="line">    TestB,</span><br><span class="line">    TestC</span><br><span class="line">&#125;TestEnum;</span><br><span class="line"></span><br><span class="line">typedef struct&#123;</span><br><span class="line">    float x,y;</span><br><span class="line">&#125;pointNode;</span><br><span class="line"></span><br><span class="line">@interface CustomizeObject : NSObject</span><br><span class="line">@property (nonatomic) NSString *name;</span><br><span class="line">@property (nonatomic) NSUInteger age;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@interface GMYTestObject : NSObject</span><br><span class="line">@property (nonatomic) char aChar;</span><br><span class="line">@property (nonatomic) int anInt;</span><br><span class="line">@property (nonatomic) short aShort;</span><br><span class="line">@property (nonatomic) long aLong;</span><br><span class="line">@property (nonatomic) long long aLongLong;</span><br><span class="line">@property (nonatomic) unsigned char anUnsignedChar;</span><br><span class="line">@property (nonatomic) unsigned int anUnsignedInt;</span><br><span class="line">@property (nonatomic) unsigned short anUnsignedShort;</span><br><span class="line">@property (nonatomic) unsigned long anUnsignedLong;</span><br><span class="line">@property (nonatomic) unsigned long long anUnsignedLongLong;</span><br><span class="line">@property (nonatomic) float aFloat;</span><br><span class="line">@property (nonatomic) double aDouble;</span><br><span class="line">@property (nonatomic) BOOL aBooL;</span><br><span class="line">@property (nonatomic) Boolean aBoolean;</span><br><span class="line">@property (nonatomic) bool abool;</span><br><span class="line">@property (nonatomic) char* aCharStar;</span><br><span class="line">@property (nonatomic) int* aIntStar;</span><br><span class="line">@property (nonatomic) void aVoid;</span><br><span class="line">@property (nonatomic) TestEnum aEnum;</span><br><span class="line">@property (nonatomic) pointNode aNode;</span><br><span class="line">@property (nonatomic) SEL aSEL;</span><br><span class="line">@property (nonatomic) id aId;</span><br><span class="line">@property (nonatomic) Class aClass;</span><br><span class="line">@property (nonatomic) NSArray&lt;NSString *&gt; *array;</span><br><span class="line">@property (nonatomic) NSArray&lt;CustomizeObject *&gt; *customizeArray;</span><br><span class="line">@property (nonatomic) NSDictionary *dictionary;</span><br><span class="line">@property (nonatomic) NSSet *aSet;</span><br><span class="line">@property (nonatomic) NSRange range;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>使用<code>ivar_getName</code>和<code>ivar_getTypeEncoding</code> 打印结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">c _aChar</span><br><span class="line">C _anUnsignedChar</span><br><span class="line">c _aBooL</span><br><span class="line">C _aBoolean</span><br><span class="line">B _abool</span><br><span class="line">s _aShort</span><br><span class="line">S _anUnsignedShort</span><br><span class="line">i _anInt</span><br><span class="line">I _anUnsignedInt</span><br><span class="line">f _aFloat</span><br><span class="line">i _aEnum</span><br><span class="line">q _aLong</span><br><span class="line">q _aLongLong</span><br><span class="line">Q _anUnsignedLong</span><br><span class="line">Q _anUnsignedLongLong</span><br><span class="line">d _aDouble</span><br><span class="line">* _aCharStar</span><br><span class="line">^i _aIntStar</span><br><span class="line">&#123;?=&quot;x&quot;f&quot;y&quot;f&#125; _aNode</span><br><span class="line">: _aSEL</span><br><span class="line">@ _aId</span><br><span class="line"># _aClass</span><br><span class="line">@&quot;NSArray&quot; _array</span><br><span class="line">@&quot;NSArray&quot; _customizeArray</span><br><span class="line">@&quot;NSDictionary&quot; _dictionary</span><br><span class="line">@&quot;NSSet&quot; _aSet</span><br><span class="line">&#123;_NSRange=&quot;location&quot;Q&quot;length&quot;Q&#125; _range</span><br></pre></td></tr></table></figure>
<blockquote>
<p>@note For possible values, see Objective-C Runtime Programming Guide &gt; Type Encodings.</p>
</blockquote>
<p>我们还可以更加直观的查看</p>
<p>使用<code>clang rewrite-objc GMYTestObject.m</code>。因为内容过多，这里只放最重要的内容。我们可以清晰的看到 <code>property</code>声明的成员变量是如何定义在<code>C++</code>文件中的。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _REWRITER_typedef_GMYTestObject</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _REWRITER_typedef_GMYTestObject</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> objc_object GMYTestObject;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;&#125; _objc_exc_GMYTestObject;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aId;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aBoolean;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_dictionary;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aEnum;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_anUnsignedChar;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_anInt;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aFloat;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_abool;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aSEL;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aNode;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_customizeArray;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aLongLong;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aChar;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aCharStar;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aDouble;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_anUnsignedShort;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_range;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aLong;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_anUnsignedLong;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_array;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aIntStar;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aBooL;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_anUnsignedInt;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aSet;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aShort;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_anUnsignedLongLong;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> OBJC_IVAR_$_GMYTestObject$_aClass;</span><br><span class="line"><span class="keyword">struct</span> GMYTestObject_IMPL &#123;</span><br><span class="line">	<span class="keyword">struct</span> NSObject_IMPL NSObject_IVARS;</span><br><span class="line">	<span class="keyword">char</span> _aChar;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> _anUnsignedChar;</span><br><span class="line">	BOOL _aBooL;</span><br><span class="line">	Boolean _aBoolean;</span><br><span class="line">	<span class="keyword">bool</span> _abool;</span><br><span class="line">	<span class="keyword">short</span> _aShort;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">short</span> _anUnsignedShort;</span><br><span class="line">	<span class="keyword">int</span> _anInt;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> _anUnsignedInt;</span><br><span class="line">	<span class="keyword">float</span> _aFloat;</span><br><span class="line">	TestEnum _aEnum;</span><br><span class="line">	<span class="keyword">long</span> _aLong;</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> _aLongLong;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">long</span> _anUnsignedLong;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> _anUnsignedLongLong;</span><br><span class="line">	<span class="keyword">double</span> _aDouble;</span><br><span class="line">	<span class="keyword">char</span> *_aCharStar;</span><br><span class="line">	<span class="keyword">int</span> *_aIntStar;</span><br><span class="line">	pointNode _aNode;</span><br><span class="line">	SEL _aSEL;</span><br><span class="line">	id _aId;</span><br><span class="line">	Class _aClass;</span><br><span class="line">	NSArray&lt;NSString *&gt; *_array;</span><br><span class="line">	NSArray&lt;CustomizeObject *&gt; *_customizeArray;</span><br><span class="line">	NSDictionary *_dictionary;</span><br><span class="line">	NSSet *_aSet;</span><br><span class="line">	NSRange _range;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// @property (nonatomic) char aChar;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) int anInt;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) short aShort;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) long aLong;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) long long aLongLong;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) unsigned char anUnsignedChar;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) unsigned int anUnsignedInt;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) unsigned short anUnsignedShort;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) unsigned long anUnsignedLong;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) unsigned long long anUnsignedLongLong;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) float aFloat;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) double aDouble;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) BOOL aBooL;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) Boolean aBoolean;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) bool abool;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) char* aCharStar;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) int* aIntStar;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) void aVoid;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) TestEnum aEnum;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) pointNode aNode;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) SEL aSEL;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) id aId;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) Class aClass;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) NSArray&lt;NSString *&gt; *array;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) NSArray&lt;CustomizeObject *&gt; *customizeArray;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) NSDictionary *dictionary;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) NSSet *aSet;</span></span><br><span class="line"><span class="comment">// @property (nonatomic) NSRange range;</span></span><br><span class="line"><span class="comment">/* @end */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// @implementation GMYTestObject</span></span><br><span class="line"><span class="comment">// @dynamic aVoid;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> instancetype _I_GMYTestObject_init(GMYTestObject * self, SEL _cmd) &#123;</span><br><span class="line">    self = ((GMYTestObject *(*)(__rw_objc_super *, SEL))(<span class="keyword">void</span> *)objc_msgSendSuper)((__rw_objc_super)&#123;(id)self, (id)class_getSuperclass(objc_getClass(<span class="string">"GMYTestObject"</span>))&#125;, sel_registerName(<span class="string">"init"</span>));</span><br><span class="line">    <span class="keyword">if</span>(self)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> _I_GMYTestObject_aChar(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">char</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aChar)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAChar_(GMYTestObject * self, SEL _cmd, <span class="keyword">char</span> aChar) &#123; (*(<span class="keyword">char</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aChar)) = aChar; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> _I_GMYTestObject_anInt(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">int</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anInt)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAnInt_(GMYTestObject * self, SEL _cmd, <span class="keyword">int</span> anInt) &#123; (*(<span class="keyword">int</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anInt)) = anInt; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">short</span> _I_GMYTestObject_aShort(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">short</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aShort)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAShort_(GMYTestObject * self, SEL _cmd, <span class="keyword">short</span> aShort) &#123; (*(<span class="keyword">short</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aShort)) = aShort; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">long</span> _I_GMYTestObject_aLong(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">long</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aLong)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setALong_(GMYTestObject * self, SEL _cmd, <span class="keyword">long</span> aLong) &#123; (*(<span class="keyword">long</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aLong)) = aLong; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">long</span> <span class="keyword">long</span> _I_GMYTestObject_aLongLong(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">long</span> <span class="keyword">long</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aLongLong)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setALongLong_(GMYTestObject * self, SEL _cmd, <span class="keyword">long</span> <span class="keyword">long</span> aLongLong) &#123; (*(<span class="keyword">long</span> <span class="keyword">long</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aLongLong)) = aLongLong; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> _I_GMYTestObject_anUnsignedChar(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">unsigned</span> <span class="keyword">char</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anUnsignedChar)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAnUnsignedChar_(GMYTestObject * self, SEL _cmd, <span class="keyword">unsigned</span> <span class="keyword">char</span> anUnsignedChar) &#123; (*(<span class="keyword">unsigned</span> <span class="keyword">char</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anUnsignedChar)) = anUnsignedChar; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> _I_GMYTestObject_anUnsignedInt(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">unsigned</span> <span class="keyword">int</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anUnsignedInt)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAnUnsignedInt_(GMYTestObject * self, SEL _cmd, <span class="keyword">unsigned</span> <span class="keyword">int</span> anUnsignedInt) &#123; (*(<span class="keyword">unsigned</span> <span class="keyword">int</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anUnsignedInt)) = anUnsignedInt; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">unsigned</span> <span class="keyword">short</span> _I_GMYTestObject_anUnsignedShort(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">unsigned</span> <span class="keyword">short</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anUnsignedShort)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAnUnsignedShort_(GMYTestObject * self, SEL _cmd, <span class="keyword">unsigned</span> <span class="keyword">short</span> anUnsignedShort) &#123; (*(<span class="keyword">unsigned</span> <span class="keyword">short</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anUnsignedShort)) = anUnsignedShort; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> _I_GMYTestObject_anUnsignedLong(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">unsigned</span> <span class="keyword">long</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anUnsignedLong)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAnUnsignedLong_(GMYTestObject * self, SEL _cmd, <span class="keyword">unsigned</span> <span class="keyword">long</span> anUnsignedLong) &#123; (*(<span class="keyword">unsigned</span> <span class="keyword">long</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anUnsignedLong)) = anUnsignedLong; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> _I_GMYTestObject_anUnsignedLongLong(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anUnsignedLongLong)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAnUnsignedLongLong_(GMYTestObject * self, SEL _cmd, <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> anUnsignedLongLong) &#123; (*(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_anUnsignedLongLong)) = anUnsignedLongLong; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">float</span> _I_GMYTestObject_aFloat(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">float</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aFloat)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAFloat_(GMYTestObject * self, SEL _cmd, <span class="keyword">float</span> aFloat) &#123; (*(<span class="keyword">float</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aFloat)) = aFloat; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">double</span> _I_GMYTestObject_aDouble(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">double</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aDouble)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setADouble_(GMYTestObject * self, SEL _cmd, <span class="keyword">double</span> aDouble) &#123; (*(<span class="keyword">double</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aDouble)) = aDouble; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> BOOL _I_GMYTestObject_aBooL(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(BOOL *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aBooL)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setABooL_(GMYTestObject * self, SEL _cmd, BOOL aBooL) &#123; (*(BOOL *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aBooL)) = aBooL; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> Boolean _I_GMYTestObject_aBoolean(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(Boolean *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aBoolean)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setABoolean_(GMYTestObject * self, SEL _cmd, Boolean aBoolean) &#123; (*(Boolean *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aBoolean)) = aBoolean; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">bool</span> _I_GMYTestObject_abool(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">bool</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_abool)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAbool_(GMYTestObject * self, SEL _cmd, <span class="keyword">bool</span> abool) &#123; (*(<span class="keyword">bool</span> *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_abool)) = abool; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> * _I_GMYTestObject_aCharStar(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">char</span> **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aCharStar)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setACharStar_(GMYTestObject * self, SEL _cmd, <span class="keyword">char</span> *aCharStar) &#123; (*(<span class="keyword">char</span> **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aCharStar)) = aCharStar; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> * _I_GMYTestObject_aIntStar(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(<span class="keyword">int</span> **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aIntStar)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAIntStar_(GMYTestObject * self, SEL _cmd, <span class="keyword">int</span> *aIntStar) &#123; (*(<span class="keyword">int</span> **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aIntStar)) = aIntStar; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> TestEnum _I_GMYTestObject_aEnum(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(TestEnum *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aEnum)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAEnum_(GMYTestObject * self, SEL _cmd, TestEnum aEnum) &#123; (*(TestEnum *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aEnum)) = aEnum; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> pointNode _I_GMYTestObject_aNode(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(pointNode *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aNode)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setANode_(GMYTestObject * self, SEL _cmd, pointNode aNode) &#123; (*(pointNode *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aNode)) = aNode; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> SEL _I_GMYTestObject_aSEL(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(SEL *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aSEL)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setASEL_(GMYTestObject * self, SEL _cmd, SEL aSEL) &#123; (*(SEL *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aSEL)) = aSEL; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> id _I_GMYTestObject_aId(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(id *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aId)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAId_(GMYTestObject * self, SEL _cmd, id aId) &#123; (*(id *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aId)) = aId; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> Class _I_GMYTestObject_aClass(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(Class *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aClass)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setAClass_(GMYTestObject * self, SEL _cmd, Class aClass) &#123; (*(Class *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aClass)) = aClass; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> NSArray&lt;NSString *&gt; * _I_GMYTestObject_array(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(NSArray&lt;NSString *&gt; **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_array)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setArray_(GMYTestObject * self, SEL _cmd, NSArray&lt;NSString *&gt; *<span class="built_in">array</span>) &#123; (*(NSArray&lt;NSString *&gt; **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_array)) = <span class="built_in">array</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> NSArray&lt;CustomizeObject *&gt; * _I_GMYTestObject_customizeArray(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(NSArray&lt;CustomizeObject *&gt; **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_customizeArray)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setCustomizeArray_(GMYTestObject * self, SEL _cmd, NSArray&lt;CustomizeObject *&gt; *customizeArray) &#123; (*(NSArray&lt;CustomizeObject *&gt; **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_customizeArray)) = customizeArray; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> NSDictionary * _I_GMYTestObject_dictionary(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(NSDictionary **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_dictionary)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setDictionary_(GMYTestObject * self, SEL _cmd, NSDictionary *dictionary) &#123; (*(NSDictionary **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_dictionary)) = dictionary; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> NSSet * _I_GMYTestObject_aSet(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(NSSet **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aSet)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setASet_(GMYTestObject * self, SEL _cmd, NSSet *aSet) &#123; (*(NSSet **)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_aSet)) = aSet; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> NSRange _I_GMYTestObject_range(GMYTestObject * self, SEL _cmd) &#123; <span class="keyword">return</span> (*(NSRange *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_range)); &#125;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _I_GMYTestObject_setRange_(GMYTestObject * self, SEL _cmd, NSRange range) &#123; (*(NSRange *)((<span class="keyword">char</span> *)self + OBJC_IVAR_$_GMYTestObject$_range)) = range; &#125;</span><br><span class="line"><span class="comment">// @end</span></span><br></pre></td></tr></table></figure>
<p> 我们都可以看到<code>property</code> 自动生成的<code>getter</code>和<code>setter</code>的实现和声明成员变量的命名符号，是不是很受冲击 - -+</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ivar/">Ivar</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Property/">Property</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2017-02-04-12年Mac Pro机械硬盘更换" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/04/2017-02-04-12年Mac Pro机械硬盘更换/">12年Mac Pro机械硬盘更换</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/02/04/2017-02-04-12年Mac Pro机械硬盘更换/" class="article-date">
  <time datetime="2017-02-04T00:00:00.000Z" itemprop="datePublished">2017-02-04</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/生活/">生活</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="12年Mac-Pro机械硬盘更换"><a href="#12年Mac-Pro机械硬盘更换" class="headerlink" title="12年Mac Pro机械硬盘更换"></a>12年Mac Pro机械硬盘更换</h2><p>这是一台12年中的高分雾面屏15寸Mac Pro。在大三(2013年)购买的，现在用起来性能是越发的不行了。开机时间巨久，所以 想着说要不把机械硬盘更换成固态硬盘。</p>
<p>更换之前，先看一下 机械硬盘的读写数据吧：</p>
<p><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/Intel%207%20Series%20Chipset.png" alt=""></p>
<h2 id="0x1-准备工作"><a href="#0x1-准备工作" class="headerlink" title="0x1 准备工作"></a>0x1 准备工作</h2><ol>
<li>一块2.5英寸的 SSD硬盘</li>
<li>一根SATA转USB 硬盘转接线<br>格外一点，购买SSD硬盘之前最好确认一下电脑的SATA 串口是第几代，这个会影响读写性能的。<br>我的是 SATA III，对应购买了 <strong>TOSHIBA A100 240GB</strong></li>
</ol>
<h2 id="0x2-备份"><a href="#0x2-备份" class="headerlink" title="0x2 备份"></a>0x2 备份</h2><ol>
<li>使用 SATA转USB硬盘转接线，将SSD硬盘接入电脑。 使用 磁盘工具 将其 格式化为 <code>Mac OS 扩展</code></li>
<li>下载 <a href="https://bombich.com/" target="_blank" rel="external">CCC - Carbon Copy Cloner</a> 将机械硬盘中的所有文件 备份到 固态硬盘中</li>
<li>按住 <code>option</code>键，重新启动。查看是否可以从固态硬盘启动系统。若可以，则备份成功</li>
</ol>
<h2 id="0x3-拆机"><a href="#0x3-拆机" class="headerlink" title="0x3 拆机"></a>0x3 拆机</h2><ol>
<li>断电，拨开电源插在主板上插头。</li>
<li>卸下锁住硬盘的螺丝，小心拔掉SATA串口线</li>
<li>安装 固态硬盘。<br><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/UNADJUSTEDNONRAW_thumb_3c5.jpg" alt=""><br><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/UNADJUSTEDNONRAW_thumb_3c6.jpg" alt=""></li>
</ol>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>开启 SSD TRIM设置，能提高SSD性能。<br>替换为 TOSHIBA A100 SSD的读写数据：<br><img src="https://raw.githubusercontent.com/778477/778477.github.io/master/img/TOSHIBA%20A100%20SSD.png" alt=""></p>
<p>READ方面提升还是蛮明显的</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSD/">SSD</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2017-01-13-Reveal调试越狱设备" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/13/2017-01-13-Reveal调试越狱设备/">Reveal 调试越狱设备</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/01/13/2017-01-13-Reveal调试越狱设备/" class="article-date">
  <time datetime="2017-01-13T00:00:00.000Z" itemprop="datePublished">2017-01-13</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a><span>></span><a class="article-category-link" href="/categories/iOS/工具/">工具</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="使用Reveal调试越狱设备"><a href="#使用Reveal调试越狱设备" class="headerlink" title="使用Reveal调试越狱设备"></a>使用Reveal调试越狱设备</h2><p>网上有很多实践文章。我自己按照网上的教程实验了一把，在这里记录一下。</p>
<ul>
<li>一台越狱设备(iOS 7.1)</li>
<li>Reveal (1.0.3)</li>
</ul>
<h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2><ol>
<li><p>确认越狱设备 安装 <code>OpenSSH</code> 和 <code>Cydia Substrate</code>。若无法安装，可以尝试刷新源，然后重新搜索下载</p>
</li>
<li><p><code>scp /Applications/Reveal.app/Contents/SharedSupport/iOS-Libraries/libReveal.dylib root@your.ip.address.xx:/Library/MobileSubstrate/DynamicLibraries</code></p>
</li>
<li><p><code>scp libReveal.plist root@192.168.XXX.XXX:/Library/MobileSubstrate/DynamicLibraries</code></p>
</li>
<li><p>重启设备，就可以在电脑查看<code>libReveal.plist</code>中的App UI了。</p>
</li>
</ol>
<p><code>libReveal.plist</code>文件格式可以为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    Filter = &#123;</span><br><span class="line">        Bundles = (&quot;com.sina.weibo&quot;);</span><br><span class="line">        Bundles = (&quot;com.burbn.instagram&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Bundles里面填写你对应想看的App SoftwareBundleIdentifier。这个Plist文件一开始，我很纠结因为网上的文件格式不同于 Apple的标准Plist XML格式。然而拷贝进越狱设备之后，能起效我也就不在意了。</p>
<h2 id="坑"><a href="#坑" class="headerlink" title="坑"></a>坑</h2><ol>
<li>我一开始使用的是Reveal 1.6.3版本，拷贝进越狱设备里的也是对应的dylib。没起作用，换了同事的1.0.3安装包就work了。</li>
<li>连接内网之后，电脑和手机一定要确认在同一个局域网(我猜想 Reveal动态库是在局域网广播UI层级信息的)</li>
</ol>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Reveal/">Reveal</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2017-01-09-ASR&amp;Translator" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/09/2017-01-09-ASR&Translator/">ASR&amp;Translator</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2017/01/09/2017-01-09-ASR&Translator/" class="article-date">
  <time datetime="2017-01-09T00:00:00.000Z" itemprop="datePublished">2017-01-09</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ASR-Automatic-Speech-Recognition"><a href="#ASR-Automatic-Speech-Recognition" class="headerlink" title="ASR(Automatic Speech Recognition)"></a>ASR(Automatic Speech Recognition)</h2><p>语音识别使用 Apple iOS10 SDK中的 speech.framework即可</p>
<p>语音识别(ASR)领域，业界还有一个leading framework： <a href="http://www.nuance.com/index.htm" target="_blank" rel="external">Nuance</a> </p>
<p>他们主要搞语音和图像方面，卖各种商业解决方案。早年间传闻 iPhone4S 那代的Siri 语音识别使用Nuance服务器</p>
<h2 id="Translator"><a href="#Translator" class="headerlink" title="Translator"></a>Translator</h2><p>语音识别之后，我们可以利用文本做一些翻译功能：</p>
<p>这里有些branchmark</p>
<ul>
<li><p><a href="http://lifehacker.com/translation-tool-showdown-google-translate-vs-microso-1787836106" target="_blank" rel="external">Translation Tool Showdown: Google Translate vs. Microsoft Translator</a></p>
</li>
<li><p><a href="https://www.slant.co/topics/5775/versus/~google-translate_vs_microsoft-translator_vs_itranslate" target="_blank" rel="external">google-translate_vs_microsoft-translator_vs_itranslate</a></p>
</li>
<li><p><a href="http://www.empowerlinguatranslation.com/microsoft-translator-vs-google-translate/" target="_blank" rel="external">Microsoft Translator Vs Google Translate</a></p>
</li>
</ul>
<p>不过因为，国内Google被墙了。大多数用户访问不了Google的服务。不用比较，只能选择Microsoft了。。。囧</p>
<p>使用Microsoft Translator服务可以实现 翻译功能<br>支持文本翻译文本，文本翻译成语音</p>
<p>Getting Started</p>
<p>To access the Microsoft Translator Text Translation API you will need to sign up for Microsoft Azure. Follow these steps.</p>
<ol>
<li>Sign up for a Microsoft Azure account at <a href="http://azure.com" target="_blank" rel="external">http://azure.com</a></li>
<li>After you have an account go to <a href="http://portal.azure.com" target="_blank" rel="external">http://portal.azure.com</a></li>
<li>Select the + New option.</li>
<li>Select Intelligence from the list of services.</li>
<li>Select Cognitive Services APIs</li>
<li>Select the API Type option.</li>
<li>Select Text Translation.</li>
<li>In the Pricing Tier section select the pricing tier that fits your needs.</li>
<li>Fill out the rest of the form, and select the Create button.</li>
<li>You are now subscribed to Microsoft Translator.</li>
<li>Go to All Resources and select the Microsoft Translator API you subscribed to.</li>
<li>Go to the Keys option and copy your subscription key to access the service.</li>
</ol>
<p><strong>Translator 文本 API</strong></p>
<table>
<thead>
<tr>
<th>Plan</th>
<th style="text-align:center">Description</th>
<th style="text-align:right">Price</th>
</tr>
</thead>
<tbody>
<tr>
<td>免费</td>
<td style="text-align:center">限每月 2M 文字</td>
<td style="text-align:right">免费</td>
</tr>
<tr>
<td>S1 标准</td>
<td style="text-align:center">基于Azure使用量</td>
<td style="text-align:right">每 1M 文字 $10</td>
</tr>
<tr>
<td>S2 标准</td>
<td style="text-align:center">每月 250M 文字</td>
<td style="text-align:right">每月 $2,055，超额部分每 1M 文字 $8.22</td>
</tr>
<tr>
<td>S3 标准</td>
<td style="text-align:center">每月 1B 文字</td>
<td style="text-align:right">每月 $6K，超额部分每 1M 文字 $6.00</td>
</tr>
<tr>
<td>S4 标准</td>
<td style="text-align:center">每月 10B 文字</td>
<td style="text-align:right">每月 $45K，超额部分每 1M 文字 $4.5</td>
</tr>
</tbody>
</table>
<p><strong>Translator 语音 API</strong></p>
<table>
<thead>
<tr>
<th>Plan</th>
<th style="text-align:center">Description</th>
<th style="text-align:right">Price</th>
</tr>
</thead>
<tbody>
<tr>
<td>免费</td>
<td style="text-align:center">限每月 2小时</td>
<td style="text-align:right">免费</td>
</tr>
<tr>
<td>S1 标准</td>
<td style="text-align:center">基于Azure使用量</td>
<td style="text-align:right">每小时 $12</td>
</tr>
<tr>
<td>S2 标准</td>
<td style="text-align:center">每月 100 小时</td>
<td style="text-align:right">每月 $1K，超出部分每小时 $10</td>
</tr>
<tr>
<td>S2 标准</td>
<td style="text-align:center">每月 1000 小时</td>
<td style="text-align:right">每月 $7K，超额部分每小时 $7</td>
</tr>
<tr>
<td>S4 标准</td>
<td style="text-align:center">每月 10,000 小时</td>
<td style="text-align:right">每月 $35K，超额部分每小时 $3.50</td>
</tr>
</tbody>
</table>
<p>PS：还有<a href="https://www.microsoft.com/cognitive-services/en-us/face-api" target="_blank" rel="external">face api</a></p>
<p>具体的文档地址：<a href="http://docs.microsofttranslator.com/text-translate.html" target="_blank" rel="external">text-translate</a></p>
<h2 id="坑"><a href="#坑" class="headerlink" title="坑"></a>坑</h2><p><del>一个封装了Microsoft Speech Translator服务的功能库<a href="https://github.com/bitmapdata/MSTranslateVendor" target="_blank" rel="external">MSTranslateVendor</a></del></p>
<p><del><a href="https://msdn.microsoft.com/en-us/library/hh454950.aspx" target="_blank" rel="external">Obtaining an Access Token</a></del></p>
<p>上面举出的Microsoft的API资料都是过期了的文档。不要花时间在这上面-，-。。。</p>
<p>一句话就是：最新的API 已经不需要去注册<code>Azure DataMarket application</code>了，不用<code>client_id</code>和<code>client_secret</code>。直接使用<code>Subscription Key</code>即可</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ASR/">ASR</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Translator/">Translator</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2016-12-29-个人开发者之游戏篇SpriteKit" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/29/2016-12-29-个人开发者之游戏篇SpriteKit/">Jumping into SpriteKit</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/12/29/2016-12-29-个人开发者之游戏篇SpriteKit/" class="article-date">
  <time datetime="2016-12-29T00:00:00.000Z" itemprop="datePublished">2016-12-29</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a><span>></span><a class="article-category-link" href="/categories/iOS/SpriteKit/">SpriteKit</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>如果你对个人开发者还有一些念想的话，游戏领域可能是个人开发者值得投入精力尝试的。<br>比起应用来说，游戏没有涉及到那么多的资源如服务端，产品经理，交互。 如果是简单的样式可能美工方面自己现学就可以搞定了<br>我这里指的是一些简单的游戏，如单场景的消除类:</p>
<ul>
<li><a href="https://itunes.apple.com/cn/app/xiao-chu-fang-kuai-2016mian/id1111099870?mt=8" target="_blank" rel="external">消除方块</a></li>
<li><a href="https://itunes.apple.com/cn/app/duo-cai-fang-kuai-xiao-chu/id943380262?mt=8" target="_blank" rel="external">多彩方块消除</a></li>
<li><a href="https://itunes.apple.com/cn/app/xing-zhi-xiao-chu!pop-star/id790766978?mt=8" target="_blank" rel="external">星之消除!pop star-免费中文消除小游戏</a></li>
</ul>
<p>大体都是一些较为经典的个人开发者作品。盈利模式可以是：App收费，App接入市场广告，App道具收费</p>
<p>好了，下面进入正题。早些年做游戏的话，如果注重跨平台 你的选择可能就是 Cocos2d-X 了。 但其实Apple自身是有套游戏框架: SpriteKit</p>
<p><a href="https://developer.apple.com/library/content/documentation/GraphicsAnimation/Conceptual/SpriteKit_PG/Introduction/Introduction.html#//apple_ref/doc/uid/TP40013043-CH1-SW1" target="_blank" rel="external">About SpriteKit</a></p>
<p>可以按照 Jumping into SpriteKit 这个章节熟悉一下 SpriteKit 。</p>
<h2 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h2><p><strong>这里要注意的是 第一步里面一定要将storyboard里面的ViewController 的view object class 设置为 SKView。</strong></p>
<blockquote>
<p>Open the storyboard for the project. It has a single view controller (SpriteViewController). Select the view controller’s view object and change its class to SKView.</p>
</blockquote>
<p><code>SpriteKit</code>内容都是绘制在<code>SKView</code>里面的，而<code>SKView</code>渲染出来的东西叫做 <em>场景(scene)</em> 是<code>SKScene</code>类型。 场景的交互是响应传递链的。</p>
<h2 id="Using-Actions-to-Animate-Scenes"><a href="#Using-Actions-to-Animate-Scenes" class="headerlink" title="Using Actions to Animate Scenes"></a>Using Actions to Animate Scenes</h2><p>每个<code>SKNode</code>都有<code>name</code>属性作为他的描述，给节点起个名字方便你后面查找和指定节点执行动作。 类似<code>UIKit</code>里面的<code>view.tag</code></p>
<p><code>SKAction</code> 需要重点了解一下。</p>
<h2 id="Transitioning-Between-Scenes"><a href="#Transitioning-Between-Scenes" class="headerlink" title="Transitioning Between Scenes"></a>Transitioning Between Scenes</h2><p>这个是区别于<code>UIKit</code>的，没有页面跳转的概念。这里指的 Scene A切换为Scene B。<br>使用<code>SKTransition</code>可以添加切换动画。查看<code>SKTransition.h</code>，SpriteKit还是自带了蛮多场景切换动画。</p>
<h2 id="Creating-Nodes-That-Interact-with-Each-Other"><a href="#Creating-Nodes-That-Interact-with-Each-Other" class="headerlink" title="Creating Nodes That Interact with Each Other"></a>Creating Nodes That Interact with Each Other</h2><p>这个是最有意思的地方： 可以添加<code>SKNode physicsBody</code>属性，让其有物理特性。<br>这里还提到了 <code>didSimulatePhysics</code>,实际上 SpriteKit中 <code>Scene</code> 是在实时重复绘制的。他的每一帧绘制包括了以下时机回调</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> Override this to perform per-frame game logic. Called exactly once per frame before any actions are evaluated and any physics are simulated.</span><br><span class="line"> </span><br><span class="line"> @param currentTime the current time in the app. This must be monotonically increasing.</span><br><span class="line"> */</span><br><span class="line">- (void)update:(NSTimeInterval)currentTime;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> Override this to perform game logic. Called exactly once per frame after any actions have been evaluated but before any physics are simulated. Any additional actions applied is not evaluated until the next update.</span><br><span class="line"> */</span><br><span class="line">- (void)didEvaluateActions;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> Override this to perform game logic. Called exactly once per frame after any actions have been evaluated and any physics have been simulated. Any additional actions applied is not evaluated until the next update. Any changes to physics bodies is not simulated until the next update.</span><br><span class="line"> */</span><br><span class="line">- (void)didSimulatePhysics;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> Override this to perform game logic. Called exactly once per frame after any enabled constraints have been applied. Any additional actions applied is not evaluated until the next update. Any changes to physics bodies is not simulated until the next update. Any changes to constarints will not be applied until the next update.</span><br><span class="line"> */</span><br><span class="line">- (void)didApplyConstraints NS_AVAILABLE(10_10, 8_0);</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> Override this to perform game logic. Called after all update logic has been completed. Any additional actions applied are not evaluated until the next update. Any changes to physics bodies are not simulated until the next update. Any changes to constarints will not be applied until the next update.</span><br><span class="line"> </span><br><span class="line"> No futher update logic will be applied to the scene after this call. Any values set on nodes here will be used when the scene is rendered for the current frame.</span><br><span class="line"> */</span><br><span class="line">- (void)didFinishUpdate NS_AVAILABLE(10_10, 8_0);</span><br></pre></td></tr></table></figure>
<p><img src="https://developer.apple.com/library/content/documentation/GraphicsAnimation/Conceptual/SpriteKit_PG/Art/update_loop_2x.png" alt="update_loop"></p>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>来自 raywenderlich 的学习资料 </p>
<ul>
<li><a href="https://www.raywenderlich.com/category/swift" target="_blank" rel="external">swift</a></li>
<li><p><a href="https://www.raywenderlich.com/category/apple-game-frameworks" target="_blank" rel="external">apple-game-frameworks</a></p>
<p>来自 apple 官方的一些资料文档</p>
</li>
<li><p><a href="https://developer.apple.com/library/content/samplecode/SpriteKit_Physics_Collisions/Introduction/Intro.html#//apple_ref/doc/uid/DTS40013390" target="_blank" rel="external">SpriteKit Physics Collisions</a></p>
</li>
<li><a href="https://developer.apple.com/library/content/samplecode/Sprite_Tour/Introduction/Intro.html#//apple_ref/doc/uid/DTS40013389" target="_blank" rel="external">Sprite Tour</a></li>
<li><a href="https://developer.apple.com/library/content/qa/qa1889/_index.html#//apple_ref/doc/uid/DTS40016267" target="_blank" rel="external">Tab-based SpriteKit Apps and Scene Caching</a></li>
</ul>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpriteKit/">SpriteKit</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <article id="post-2016-12-29-iOS 动态方案探讨" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/29/2016-12-29-iOS 动态方案探讨/">动态化方案</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/12/29/2016-12-29-iOS 动态方案探讨/" class="article-date">
  <time datetime="2016-12-29T00:00:00.000Z" itemprop="datePublished">2016-12-29</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS/">iOS</a><span>></span><a class="article-category-link" href="/categories/iOS/动态化方案/">动态化方案</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="已知的一些动态化方案"><a href="#已知的一些动态化方案" class="headerlink" title="已知的一些动态化方案"></a>已知的一些动态化方案</h2><ul>
<li><a href="https://github.com/spotify/HubFramework" target="_blank" rel="external">HubFramework</a></li>
<li><a href="https://github.com/alibaba/weex" target="_blank" rel="external">weex</a></li>
<li><a href="https://github.com/facebook/react-native" target="_blank" rel="external">react-native</a></li>
<li><a href="http://mp.weixin.qq.com/s/DhGR6J5fx04BPi-kMsMBJg" target="_blank" rel="external">OCS</a></li>
<li><a href="https://github.com/DynamicCocoa/DynamicCocoa/issues" target="_blank" rel="external">DynamicCocoa</a></li>
</ul>
<h2 id="List-解耦方案"><a href="#List-解耦方案" class="headerlink" title="List 解耦方案"></a>List 解耦方案</h2><ul>
<li><a href="https://github.com/Instagram/IGListKit" target="_blank" rel="external">IGListKit</a></li>
</ul>
<p>动态化方案的价值，这里就不讨论了。</p>

      
    </div>
    
    
      <footer class="article-footer">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/动态化方案/">动态化方案</a></li></ul>

      </footer>
    
  </div>
  
</article>


    
      <nav id="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
      </nav>
    </section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 miaoyou.gmy&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
  </div>
</body>
</html>